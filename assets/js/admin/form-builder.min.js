!function(p,m){var f,u={init:function(){p(document).ready(function(e){e("evf-panel-integrations-button a").hasClass("active")||(e("#everest-forms-panel-integrations").find(".everest-forms-panel-sidebar a").first().addClass("active"),e("#everest-forms-panel-integrations").find(".everest-forms-panel-sidebar a").hasClass("active")&&e("#everest-forms-panel-integrations").find(".everest-forms-panel-sidebar a").next(".everest-forms-active-connections").first().addClass("active"),e(".everest-forms-panel-content").find(".evf-panel-content-section").first().addClass("active"))}),p(document).ready(function(s){"1"===s(".everest-forms-min-max-date-format input").val()&&s(".everest-forms-min-max-date-option").find("input").datepicker({defaultDate:"",dateFormat:"yy-mm-dd",numberOfMonths:1,showButtonPanel:!0,onSelect:function(){var e=s(this).is(".everest-forms-min-date")?"minDate":"maxDate",t=s(this).closest(".everest-forms-min-max-date-option").find("input"),i=s(this).datepicker("getDate");t.not(this).datepicker("option",e,i),s(this).change()}}),s("evf-panel-payments-button a").hasClass("active")||(s("#everest-forms-panel-payments").find(".everest-forms-panel-sidebar a").first().addClass("active"),s(".everest-forms-panel-content").find(".evf-payment-setting-content").first().addClass("active"))}),p(document.body).find("#copy-shortcode").on("click",this.copyShortcode).on("aftercopy",this.copySuccess).on("aftercopyfailure",this.copyFail),p(document.body).find(".evf-copy-shortcode").each(function(){p(this).on("click",u.copyShortcode).on("aftercopy",u.copySuccess).on("aftercopyfailure",u.copyFail)}),p(document).ready(u.ready),p(window).on("load",u.load),p(document.body).on("evf-init-builder-fields",function(){u.bindFields()}).trigger("evf-init-builder-fields"),p(document.body).on("adjust_builder_width",function(){var e=p("#adminmenuwrap").width();p("#everest-forms-builder-form").css({width:"calc(100% - "+e+"px)"})}).trigger("adjust_builder_width"),p(document.body).on("click","#collapse-button",function(){p("#everest-forms-builder-form").width(""),p(document.body).trigger("adjust_builder_width")}),p(window).on("resize orientationchange",function(){clearTimeout(void 0),setTimeout(function(){p("#everest-forms-builder").width(""),p(document.body).trigger("adjust_builder_width")},250)}).trigger("resize")},copyShortcode:function(e){evfClearClipboard(),evfSetClipboard(p(this).closest(".evf-shortcode-field").find("input").val(),p(this)),e.preventDefault()},copySuccess:function(){p(this).tooltipster("content",p(this).attr("data-copied")).trigger("mouseenter").on("mouseleave",function(){var e=p(this);setTimeout(function(){e.tooltipster("content",e.attr("data-tip"))},1e3)})},copyFail:function(){p(this).closest(".evf-shortcode-field").find("input").focus().select()},load:function(){p(".everest-forms-overlay").fadeOut()},ready:function(){var e,t;f=p("#everest-forms-builder"),u.bindUIActions(),u.bindEditActions(),jconfirm.defaults={closeIcon:!0,backgroundDismiss:!0,escapeKey:!0,animationBounce:1,useBootstrap:!1,theme:"modern",boxWidth:"400px",columnClass:"evf-responsive-class"},"undefined"!=typeof PerfectScrollbar&&(e=p(".everest-forms-tab-content"),t=p(".everest-forms-panel"),1<=e.length&&(window.evf_tab_scroller=new PerfectScrollbar(".everest-forms-tab-content",{suppressScrollX:!0})),t.each(function(){var e=p(this),t=e.attr("id");1<=e.find(".everest-forms-panel-sidebar").length&&(window.evf_setting_scroller=new PerfectScrollbar("#"+t+" .everest-forms-panel-sidebar"))})),f.on("change",".everest-forms-field-option-row-limit_enabled input",function(e){u.updateTextFieldsLimitControls(p(e.target).parents(".everest-forms-field-option-row-limit_enabled").data().fieldId,e.target.checked)}),f.on("change",".everest-forms-field-option-select .everest-forms-field-option-row-enhanced_select input",function(e){u.enhancedSelectFieldStyle(p(e.target).parents(".everest-forms-field-option-row-enhanced_select").data().fieldId,e.target.checked)}),f.on("click",".everest-forms-field-option-row-choices .everest-forms-btn-group span",function(e){p(this).hasClass("upgrade-modal")&&"checkbox"===p(this).data("type")?(p(this).parent().find("span").addClass("is-active"),p(this).removeClass("is-active"),u.updateEnhandedSelectField(p(e.target).parents(".everest-forms-field-option-row-choices").data().fieldId,!1)):(p(this).parent().find("span").removeClass("is-active"),p(this).addClass("is-active"),u.updateEnhandedSelectField(p(e.target).parents(".everest-forms-field-option-row-choices").data().fieldId,"multiple"===p(this).data("selection")))}),f.on("keyup",".everest-forms-search-fields",function(){var t=p(this).val().toLowerCase();p(".evf-registered-item").each(function(){var e=p(this);field_type=e.data("field-type"),field_label=e.text().toLowerCase(),-1<field_type.search(t)||-1<field_label.search(t)?(e.addClass("evf-searched-item"),e.show()):(e.removeClass("evf-searched-item"),e.hide())}),p(".everest-forms-add-fields-group").each(function(){p(this).find(".evf-registered-item.evf-searched-item").length<=0?p(this).hide():p(this).show()}),p(".evf-registered-item.evf-searched-item").length?p(".everest-forms-fields-not-found").addClass("hidden"):p(".everest-forms-fields-not-found").removeClass("hidden")}),p(document).trigger("everest_forms_ready")},updateTextFieldsLimitControls:function(e,t){t?p("#everest-forms-field-option-row-"+e+"-limit_controls").removeClass("everest-forms-hidden"):p("#everest-forms-field-option-row-"+e+"-limit_controls").addClass("everest-forms-hidden")},enhancedSelectFieldStyle:function(e,t){var i=p("#everest-forms-field-"+e+" .primary-input"),s=p("#everest-forms-field-option-"+e+"-enhanced_select").is(":checked");t&&s&&i.prop("multiple")?(i.addClass("evf-enhanced-select"),p(document.body).trigger("evf-enhanced-select-init")):(i.removeClass("evf-enhanced-select enhanced"),i.filter(".select2-hidden-accessible").selectWoo("destroy"))},updateEnhandedSelectField:function(e,t){var i=p("#everest-forms-field-"+e+" .primary-input"),s=i.find(".placeholder"),o=p("#everest-forms-field-option-"+e+"-multiple_choices"),n=p("#everest-forms-field-option-row-"+e+"-choices input.default"),a=n.filter(":checked");o.val(t?1:0),i.prop("multiple",t),n.prop("type",t?"checkbox":"radio"),!t&&a.length&&(n.prop("checked",!1),p(a.get(0)).prop("checked",!0)),s.length&&t&&s.prop("selected",!t),u.enhancedSelectFieldStyle(e,t)},bindUIActions:function(){u.bindDefaultTabs(),u.checkEmptyGrid(),u.bindFields(),u.bindFormPreview(),u.bindGridSwitcher(),u.bindFieldSettings(),u.bindFieldDelete(),u.bindCloneField(),u.bindSaveOption(),u.bindAddNewRow(),u.bindRemoveRow(),u.bindFormSettings(),u.bindFormEmail(),u.bindFormIntegrations(),u.bindFormPayment(),u.choicesInit(),u.bindToggleHandleActions(),u.bindLabelEditInputActions(),u.bindSyncedInputActions(),u.init_datepickers(),u.bindBulkOptionActions(),u.bindUIActionsFields(),"field-options"===m.tab&&p(".evf-panel-field-options-button").trigger("click")},bindBulkOptionActions:function(){p(document.body).on("click",".evf-toggle-bulk-options",function(e){p(this).closest(".everest-forms-field-option").find(".everest-forms-field-option-row-add_bulk_options").slideToggle()}),p(document.body).on("click",".evf-toggle-presets-list",function(e){p(this).closest(".everest-forms-field-option").find(".everest-forms-field-option-row .evf-options-presets").slideToggle()}),p(document.body).on("click",".evf-add-bulk-options",function(e){var t,i,s,o=p(this).closest(".everest-forms-field-option-row"),n=o.data("field-id");o.length&&(t=o.closest(".everest-forms-field-option").find(".everest-forms-field-option-row-choices .evf-choices-list"),s=(i=o.find("textarea#everest-forms-field-option-"+n+"-add_bulk_options")).val().split("\n"),u.addBulkOptions(s,t),i.val(""))}),p(document.body).on("click",".evf-options-preset-label",function(e){var t,i=p(this).closest(".everest-forms-field-option-row"),s=i.data("field-id");i.length&&(t=p(this).closest(".evf-options-preset").find(".evf-options-preset-value").val(),i.find("textarea#everest-forms-field-option-"+s+"-add_bulk_options").val(t),p(this).closest(".evf-options-presets").slideUp())})},addBulkOptions:function(e,i){e.forEach(function(e){var t;""!==e&&(t=i.find("li").last().find("a.add"),u.choiceAdd(null,t,e.trim()))})},init_datepickers:function(){var e=p(".everest-forms-disable-dates").data("date-format");p(".everest-forms-disable-dates").each(function(){p(this).get(0)._flatpickr||p(this).flatpickr({dateFormat:e,mode:"multiple"})}),p(document.body).on("change",".evf-date-format",function(e){var t=p(".everest-forms-field-option:visible .everest-forms-disable-dates"),i=t.get(0)._flatpickr,s=i.selectedDates,o=p(this).val(),n=[];s.forEach(function(e){n.push(flatpickr.formatDate(e,o))}),i.set("dateFormat",o),t.val(n.join(", "))}),p(document.body).on("click",".evf-clear-disabled-dates",function(){p(".everest-forms-field-option:visible .everest-forms-disable-dates").get(0)._flatpickr.clear()})},bindEditActions:function(){p("#edit-form-name").on("click",function(e){e.stopPropagation(),""!==p("#evf-edit-form-name").val().trim()&&u.toggleEditTitle(e)}),p("#evf-edit-form-name").on("change keypress",function(e){var t=p(this);e.stopPropagation(),13===e.which&&""!==p(this).val().trim()&&u.toggleEditTitle(e),""!==t.val().trim()&&p("#everest-forms-panel-field-settings-form_title").val(t.val().trim())}).on("click",function(e){e.stopPropagation()}),p(document).not(p(".everest-forms-title-desc")).on("click",function(e){var t=p("#evf-edit-form-name");e.stopPropagation(),!t.prop("disabled")&&t.val()&&""!==t.val().trim()&&u.toggleEditTitle(e)})},toggleEditTitle:function(e){var t=p("#edit-form-name").siblings("#evf-edit-form-name");e.preventDefault(),t.prop("disabled",function(e,t){return!t}),t.hasClass("everst-forms-name-editing")||t.focus(),t.toggleClass("everst-forms-name-editing")},formObject:function(e){for(var t=jQuery(e).find("[name]"),i={},s={},o=0;o<t.length;o++){var n=jQuery(t[o]),a=n.prop("name").replace(/\]/gi,"").split("["),r=n.val(),d={};if(!n.is(":radio")&&!n.is(":checkbox")||n.is(":checked")){for(var l=a.length-1;0<=l;l--){var f=a[l];if(void 0===f&&(f=""),0===f.length&&(d=[],"undefined"==typeof s[a[l-1]]?s[a[l-1]]=0:s[a[l-1]]+=1,f=s[a[l-1]]),l===a.length-1){if(r)if("true"===r)r=!0;else if("false"===r)r=!1;else if(isNaN(parseFloat(r))||parseFloat(r).toString()!==r)if("string"!=typeof r||"{"!==r.substr(0,1)&&"["!==r.substr(0,1)){if("object"==typeof r&&r.length&&n.is("select")){for(var c={},l=0;l<r.length;l++)c["n"+l]=r[l];r=c}}else try{r=JSON.parse(r)}catch(m){}else r=parseFloat(r);d[f]=r}else{var v=d;(d={})[f]=v}}p.extend(!0,i,d)}}return i},bindUIActionsFields:function(){f.on("click",".everest-forms-field-option-row-choices .add",function(e){u.choiceAdd(e,p(this))}),f.on("click",".everest-forms-field-option-row-choices .remove",function(e){u.choiceDelete(e,p(this))}),f.on("mousedown",".everest-forms-field-option-row-choices input[type=radio]",function(){var e=p(this);e.is(":checked")?e.attr("data-checked","1"):e.attr("data-checked","0")}),f.on("click",".everest-forms-field-option-row-choices input[type=radio]",function(){var e=p(this),t=e.parent().parent();e.parent().parent().find("input[type=radio]").not(this).prop("checked",!1),"1"===e.attr("data-checked")&&(e.prop("checked",!1),e.attr("data-checked","0")),u.choiceUpdate(t.data("field-type"),t.data("field-id"))}),f.on("change",".everest-forms-field-option-row-choices input[type=checkbox]",function(e){var t=p(this).parent().parent();u.choiceUpdate(t.data("field-type"),t.data("field-id"))}),f.on("keyup paste focusout",".everest-forms-field-option-row-choices input.label",function(e){var t=p(this).parent().parent().parent();u.choiceUpdate(t.data("field-type"),t.data("field-id"))}),f.on("change",".everest-forms-field-option-row-show_values input",function(e){p(this).closest(".everest-forms-field-option").find(".everest-forms-field-option-row-choices ul").toggleClass("show-values")}),f.on("change",".everest-forms-field-option-row-choices_images input",function(){var e=p(this),t=e.parent().data("field-id"),i=p("#everest-forms-field-option-"+t),s=p("#everest-forms-field-option-"+t+"-input_columns"),o=p("#everest-forms-field-option-"+t).find(".everest-forms-field-option-hidden-type").val();e.parent().find(".notice").toggleClass("hidden"),i.find(".everest-forms-field-option-row-choices ul").toggleClass("show-images"),e.is(":checked")?s.val("inline").trigger("change"):s.val("").trigger("change"),u.choiceUpdate(o,t)}),f.on("click",".everest-forms-attachment-media-view .upload-button",function(e){var t,i,s=p(this);e.preventDefault(),i||(i=wp.media.frames.everestforms_media_frame=wp.media({title:m.i18n_upload_image_title,className:"media-frame everest-forms-media-frame",frame:"select",multiple:!1,library:{type:"image"},button:{text:m.i18n_upload_image_button}})).on("select",function(){var e=i.state().get("selection").first().toJSON();(t=s.hasClass("button-add-media")?(s.hide(),s.parent()):s.parent().parent().parent()).find(".source").val(e.url),t.find(".attachment-thumb").remove(),t.find(".thumbnail-image").prepend('<img class="attachment-thumb" src="'+e.url+'">'),t.find(".actions").show(),f.trigger("everestFormsImageUploadAdd",[s,t])}),i.open()}),f.on("click",".everest-forms-attachment-media-view .remove-button",function(e){e.preventDefault();var t=p(this).parent().parent();t.find(".attachment-thumb").remove(),t.parent().find(".source").val(""),t.parent().find(".button-add-media").show(),f.trigger("everestFormsImageUploadRemove",[p(this),t])}),f.on("everestFormsImageUploadAdd everestFormsImageUploadRemove",function(e,t,i){var s=i.closest(".evf-choices-list"),o=s.data("field-type"),n=s.data("field-id");u.choiceUpdate(o,n)}),f.on("change",".everest-forms-field-option-row-input_columns select",function(){var e=p(this),t=e.val(),i=e.parent().data("field-id"),s="";"inline"===t?s="everest-forms-list-inline":""!==t&&(s="everest-forms-list-"+t+"-columns"),p("#everest-forms-field-"+i).removeClass("everest-forms-list-inline everest-forms-list-2-columns everest-forms-list-3-columns").addClass(s)}),f.on("click",".everest-forms-fields-tab a",function(e){e.preventDefault(),u.fieldTabChoice(p(this).attr("id"))}),f.on("change",".everest-forms-field-option-address input.hide",function(){var e=p(this),t=e.parent().parent().data("field-id"),i=e.parent().parent().data("subfield");p("#everest-forms-field-"+t).find(".everest-forms-"+i).toggleClass("hidden")}),f.on("input",".everest-forms-field-option-row-label input",function(){var e=p(this),t=e.val(),i=e.parent().data("field-id");$label=p("#everest-forms-field-"+i).find(".label-title .text"),$label.hasClass("nl2br")?$label.html(t.replace(/\n/g,"<br>")):$label.html(t)}),f.on("input",".everest-forms-field-option-row-description textarea",function(){var e=p(this),t=e.val(),i=e.parent().data("field-id"),s=p("#everest-forms-field-"+i).find(".description");s.hasClass("nl2br")?s.html(t.replace(/\n/g,"<br>")):s.html(t)}),f.on("change",".everest-forms-field-option-row-required input",function(e){var t=p(this).parent().data("field-id");p("#everest-forms-field-"+t).toggleClass("required"),p(e.target).is(":checked")?p("#everest-forms-field-option-row-"+t+"-required-field-message").show():p("#everest-forms-field-option-row-"+t+"-required-field-message").hide()}),f.on("change",".everest-forms-field-option-row-confirmation input",function(e){var t=p(this).parent().data("field-id");p(e.target).is(":checked")?(p("#everest-forms-field-"+t).find(".everest-forms-confirm").removeClass("everest-forms-confirm-disabled").addClass("everest-forms-confirm-enabled"),p("#everest-forms-field-option-"+t).removeClass("everest-forms-confirm-disabled").addClass("everest-forms-confirm-enabled")):(p("#everest-forms-field-"+t).find(".everest-forms-confirm").removeClass("everest-forms-confirm-enabled").addClass("everest-forms-confirm-disabled"),p("#everest-forms-field-option-"+t).removeClass("everest-forms-confirm-enabled").addClass("everest-forms-confirm-disabled"))}),f.on("input",".everest-forms-field-option-row-placeholder input",function(e){var t=p(this),i=t.val(),s=t.parent().data("field-id"),o=p("#everest-forms-field-"+s).find(".widefat:not(.secondary-input)");o.is("select")?i.length?(o.find(".placeholder").length?o.find(".placeholder").text(i):o.prepend('<option class="placeholder" selected>'+i+"</option>"),o.data("placeholder",i),o.hasClass("enhanced")&&o.parent().find(".select2-search__field").prop("placeholder",i)):o.find(".placeholder").remove():o.attr("placeholder",i)}),f.on("input",".everest-forms-field-option-address input.placeholder",function(e){var t=p(this),i=t.val(),s=t.parent().parent().data("field-id"),o=t.parent().parent().data("subfield");p("#everest-forms-field-"+s).find(".everest-forms-"+o+" input").attr("placeholder",i)}),f.on("input",".everest-forms-field-option-row-confirmation_placeholder input",function(){var e=p(this),t=e.val(),i=e.parent().data("field-id");p("#everest-forms-field-"+i).find(".secondary-input").attr("placeholder",t)}),f.on("change",".everest-forms-field-option-row-label_hide input",function(){var e=p(this).parent().data("field-id");p("#everest-forms-field-"+e).toggleClass("label_hide")}),f.on("change",".everest-forms-field-option-row-sublabel_hide input",function(){var e=p(this).parent().data("field-id");p("#everest-forms-field-"+e).toggleClass("sublabel_hide")}),f.on("change",".everest-forms-field-option-row-datetime_format select, .everest-forms-field-option-row-phone_format select, .everest-forms-field-option-row-item_price select, .everest-forms-field-option-row-format select",function(e){var t=p(this),i=t.val(),s=t.parent().data("field-id");p("#everest-forms-field-"+s).find(".format-selected").removeClass().addClass("format-selected format-selected-"+i),p("#everest-forms-field-option-"+s).find(".format-selected").removeClass().addClass("format-selected format-selected-"+i)})},choicesInit:function(e){p(e=e||".everest-forms-field-option-row-choices ul").sortable({items:"li",axis:"y",handle:".sort",scrollSensitivity:40,stop:function(e){var t=p(e.target).attr("data-field-id"),i=p("#everest-forms-field-option-"+t).find(".everest-forms-field-option-hidden-type").val();u.choiceUpdate(i,t)}})},choiceAdd:function(e,t,i){e&&e.preventDefault&&e.preventDefault();var s=p(t),o=s.parent(),n=o.find("input.default").is(":checked"),a=s.closest(".everest-forms-field-option-row-choices").data("field-id"),r=o.parent().attr("data-next-id"),d=o.parent().data("field-type"),l=o.clone().insertAfter(o);l.attr("data-key",r),l.find("input.label").val(i).attr("name","form_fields["+a+"][choices]["+r+"][label]"),l.find("input.value").val(i).attr("name","form_fields["+a+"][choices]["+r+"][value]"),l.find("input.source").val("").attr("name","form_fields["+a+"][choices]["+r+"][image]"),l.find("input.default").attr("name","form_fields["+a+"][choices]["+r+"][default]").prop("checked",!1),l.find(".attachment-thumb").remove(),l.find(".button-add-media").show(),!0===n&&o.find("input.default").prop("checked",!0),r++,o.parent().attr("data-next-id",r),f.trigger("everestFormsChoiceAdd"),u.choiceUpdate(d,a)},choiceDelete:function(e,t){e.preventDefault();var i=p(t),s=i.parent().parent();s.find("li").length<2?p.alert({title:!1,content:m.i18n_field_error_choice,icon:"dashicons dashicons-info",type:"blue",buttons:{ok:{text:m.i18n_ok,btnClass:"btn-confirm",keys:["enter"]}}}):(i.parent().remove(),u.choiceUpdate(s.data("field-type"),s.data("field-id")),f.trigger("everestFormsChoiceDelete"))},choiceUpdate:function(n,a){var r,e=p("#everest-forms-field-option-"+a);if($primary=p("#everest-forms-field-"+a+" .primary-input"),"radio"===n||"checkbox"===n||"payment-multiple"===n||"payment-checkbox"===n){var t=[],i=u.formObject(e).form_fields[a];p("#everest-forms-field-option-"+a).find(".evf-choices-list li").each(function(){t.push(p(this).data("key"))});var s=wp.template("everest-forms-field-preview-choices");return data={type:n="checkbox"===n||"payment-checkbox"===n?"checkbox":"radio",order:t,settings:i},void p("#everest-forms-field-"+a).find("ul.primary-input").replaceWith(s(data))}"select"===n&&(r="<option>{label}</option>",$primary.find("option").not(".placeholder").remove()),p("#everest-forms-field-option-row-"+a+"-choices .evf-choices-list li").each(function(e){var t=p(this),i=t.find("input.label").val(),s=t.find("input.default").is(":checked"),o=p(r.replace("{label}",i));if(p("#everest-forms-field-"+a+" .primary-input").append(o),i&&!0===s)switch(n){case"select":o.prop("selected",!0);break;case"radio":case"checkbox":o.find("input").prop("checked",!0)}})},bindFormSettings:function(){p("body").on("click",".evf-setting-panel",function(e){var t=p(this).attr("data-section");p(".evf-setting-panel").removeClass("active"),p(".everest-forms-active-email").removeClass("active"),p(".evf-content-section").removeClass("active"),p(this).addClass("active"),p(".evf-content-"+t+"-settings").addClass("active"),e.preventDefault()}),p(".evf-setting-panel").eq(0).trigger("click")},bindFormEmail:function(){p("body").on("click",".everest-forms-panel-sidebar-section-email",function(e){p(this).siblings(".everest-forms-active-email").removeClass("active"),p(this).next(".everest-forms-active-email").addClass("active");var t=p(this).siblings(".everest-forms-active-email.active").find(".everest-forms-active-email-connections-list li");t.length&&t.children(".user-nickname").first().trigger("click"),e.preventDefault()})},bindFormIntegrations:function(){p("body").on("click",".evf-integrations-panel",function(e){var t=p(this).attr("data-section");p(".evf-integrations-panel").removeClass("active"),p("#everest-forms-panel-integrations").find(".evf-panel-content-section").removeClass("active"),p(this).addClass("active"),p(this).parent().find(".everest-forms-active-connections").removeClass("active"),p(this).next(".everest-forms-active-connections").addClass("active");var i=p(this).siblings(".everest-forms-active-connections.active").find(".everest-forms-active-connections-list li");i.length&&i.children(".user-nickname").first().trigger("click"),p(".evf-panel-content-section-"+t).addClass("active"),e.preventDefault()}),p(".evf-setting-panel").eq(0).trigger("click")},bindFormPayment:function(){p("body").on("click",".evf-payments-panel",function(e){var t=p(this).attr("data-section");p(".evf-payments-panel").removeClass("active"),p(this).siblings().removeClass("icon active"),p(this).addClass("active"),p(this).parents("#everest-forms-panel-payments").find(".evf-payment-setting-content").removeClass("active").hide(),p(".evf-content-"+t+"-settings").addClass("active").show(),e.preventDefault()}),p(".evf-setting-panel").eq(0).trigger("click")},removeRow:function(e){p.each(e.find(".everest-forms-field"),function(){var e=p(this).attr("data-field-id"),t=p("#everest-forms-field-option-"+e);p(this).remove(),t.remove()}),e.remove()},bindRemoveRow:function(){p("body").on("click",".evf-delete-row",function(){var e=p(this),t=p(".evf-admin-row").length,i=e.closest(".evf-admin-row"),s=e.parents(".evf-admin-field-container").attr("data-current-part"),o=p("#everest-forms-builder").hasClass("multi-part-activated");s&&o&&(t=p("#part_"+s).find(".evf-admin-row").length),t<2?p.alert({title:m.i18n_row_locked,content:m.i18n_row_locked_msg,icon:"dashicons dashicons-info",type:"blue",buttons:{confirm:{text:m.i18n_close,btnClass:"btn-confirm",keys:["enter"]}}}):p.confirm({title:!1,content:m.i18n_delete_row_confirm,type:"red",closeIcon:!1,backgroundDismiss:!1,icon:"dashicons dashicons-warning",buttons:{confirm:{text:m.i18n_ok,btnClass:"btn-confirm",keys:["enter"],action:function(){u.removeRow(i)}},cancel:{text:m.i18n_cancel}}})})},bindAddNewRow:function(){p("body").on("click",".evf-add-row span",function(){var e=p(this),t=p(".evf-admin-field-wrapper"),i=p(".evf-admin-row").map(function(){return p(this).data("row-id")}).get(),s=Math.max.apply(Math,i),o=p(".evf-admin-row").eq(0).clone(),n=e.parent().attr("data-total-rows"),a=e.parents(".evf-admin-field-container").attr("data-current-part");s++,n++,a&&(t=p(".evf-admin-field-wrapper").find("#part_"+a)),o.find(".evf-admin-grid").html(""),o.attr("data-row-id",s),e.parent().attr("data-total-rows",n),e.parent().attr("data-next-row-id",s),t.append(o),u.bindFields(),u.checkEmptyGrid()})},bindCloneField:function(){p("body").on("click",".everest-forms-preview .everest-forms-field .everest-forms-field-duplicate",function(){var e=p(this).closest(".everest-forms-field");e.hasClass("no-duplicate")?p.alert({title:m.i18n_field_locked,content:m.i18n_field_locked_msg,icon:"dashicons dashicons-info",type:"blue",buttons:{confirm:{text:m.i18n_close,btnClass:"btn-confirm",keys:["enter"]}}}):p.confirm({title:!1,content:m.i18n_duplicate_field_confirm,type:"orange",closeIcon:!1,backgroundDismiss:!1,icon:"dashicons dashicons-warning",buttons:{confirm:{text:m.i18n_ok,btnClass:"btn-confirm",keys:["enter"],action:function(){u.cloneFieldAction(e)}},cancel:{text:m.i18n_cancel}}})})},cloneFieldAction:function(s){var o=s.attr("data-field-id"),e=m.form_id,t={action:"everest_forms_get_next_id",security:m.evf_get_next_id,form_id:e};p.ajax({url:m.ajax_url,data:t,type:"POST",beforeSend:function(){p(document.body).trigger("init_field_options_toggle")},success:function(e){var t,i;"boolean"==typeof e.success&&!0===e.success&&(t=e.data.field_id,i=e.data.field_key,p("#everest-forms-field-id").val(t),u.render_node(s,o,i),p(document.body).trigger("init_field_options_toggle"))}})},render_node:function(e,o,n){var t=p(".everest-forms-field-options #everest-forms-field-option-"+o),i=p("#everest-forms-field-option-"+o+"-label").val(),s=p("#everest-forms-field-option-"+o+"-meta-key").length?p("#everest-forms-field-option-"+o+"-meta-key").val():"",a=e.attr("data-field-type"),r=t.html(),d=i+" "+m.i18n_copy,l="html"!==a?s.replace(/\(|\)/g,"").toLowerCase().substring(0,s.lastIndexOf("_"))+"_"+Math.floor(1e3+9e3*Math.random()):"",f=e.clone(),c=new RegExp(o,"g"),r=r.replace(c,n),v=p('<div class="everest-forms-field-option everest-forms-field-option-'+a+'" id="everest-forms-field-option-'+n+'" data-field-id="'+n+'" />');v.append(r),p.each(t.find(":input"),function(){var e,t,i=p(this).attr("type"),s=(p(this).attr("name")?p(this).attr("name"):"").replace(c,n);"text"===i||"hidden"===i?(e=p(this).val(),v.find('input[name="'+s+'"]').val(e),v.find('input[value="'+o+'"]').val(n)):"checkbox"===i||"radio"===i?p(this).is(":checked")?v.find('input[name="'+s+'"]').prop("checked",!0).attr("checked","checked"):v.find('[name="'+s+'"]').prop("checked",!1).attr("checked",!1):p(this).is("select")?p(this).find("option:selected").length&&(t=p(this).find("option:selected").val(),v.find('[name="'+s+'"]').find('[value="'+t+'"]').prop("selected",!0)):""!==p(this).val()&&v.find('[name="'+s+'"]').val(p(this).val())}),p(".everest-forms-field-options").append(v),p("#everest-forms-field-option-"+n+"-label").val(d),p("#everest-forms-field-option-"+n+"-meta-key").val(l),f.attr("class",e.attr("class")),f.attr("id","everest-forms-field-"+n),f.attr("data-field-id",n),f.attr("data-field-type",a),f.find(".label-title .text").text(d),e.closest(".evf-admin-grid").find('[data-field-id="'+o+'"]').after(f),p(document).trigger("everest-form-cloned",[n,a]),u.switchToFieldOptionPanel(n),p(document.body).trigger("evf_render_node_complete",[a,n,f,v])},bindFieldDelete:function(){p("body").on("click",".everest-forms-preview .everest-forms-field .everest-forms-field-delete",function(){var t=p(this).closest(".everest-forms-field"),e=t.attr("data-field-id"),i=p("#everest-forms-field-option-"+e);p(this).closest(".evf-admin-grid");t.hasClass("no-delete")?p.alert({title:m.i18n_field_locked,content:m.i18n_field_locked_msg,icon:"dashicons dashicons-info",type:"blue",buttons:{confirm:{text:m.i18n_close,btnClass:"btn-confirm",keys:["enter"]}}}):p.confirm({title:!1,content:m.i18n_delete_field_confirm,type:"red",closeIcon:!1,backgroundDismiss:!1,icon:"dashicons dashicons-warning",buttons:{confirm:{text:m.i18n_ok,btnClass:"btn-confirm",keys:["enter"],action:function(){p(".evf-panel-fields-button").trigger("click"),t.fadeOut("slow",function(){var e=t.attr("data-field-id");p(document.body).trigger("evf_before_field_deleted",[e]),t.remove(),i.remove(),u.checkEmptyGrid(),p(".everest-forms-fields-tab").find("a").removeClass("active"),p(".everest-forms-fields-tab").find("a").first().addClass("active"),p(".everest-forms-add-fields").show(),u.conditionalLogicRemoveField(e),u.conditionalLogicRemoveFieldIntegration(e),u.paymentFieldRemoveFromQuantity(e)})}},cancel:{text:m.i18n_cancel}}})})},bindSaveOption:function(){p("body").on("click",".everest-forms-save-button",function(){var t=p(this),e=p("form#everest-forms-builder-form"),i=u.getStructure(),s=e.serializeArray();if(""!==p("#evf-edit-form-name").val().trim()){e.triggerHandler("everest_forms_process_ajax_data",[t,s])&&(s=e.triggerHandler("everest_forms_process_ajax_data",[t,s])),p(".everest-forms-panel-content-wrap").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var o=[];p(".everest-forms-field[data-field-id]").each(function(){o.push(p(this).attr("data-field-id"))});for(var n,a=s.length;a--;){s[a].name.startsWith("form_fields")&&(n=!1,o.forEach(function(e){s[a].name.startsWith("form_fields["+e+"]")&&(n=!0)}),-1<a&&!1===n&&s.splice(a,1))}var r=s.concat(i),d={action:"everest_forms_save_form",security:m.evf_save_form,form_data:JSON.stringify(r)};p.ajax({url:m.ajax_url,data:d,type:"POST",beforeSend:function(){t.addClass("processing"),t.find(".loading-dot").remove(),t.append('<span class="loading-dot"></span>')},success:function(e){t.removeClass("processing"),t.find(".loading-dot").remove(),e.success||p.alert({title:e.data.errorTitle,content:e.data.errorMessage,icon:"dashicons dashicons-warning",type:"red",buttons:{ok:{text:m.i18n_ok,btnClass:"btn-confirm",keys:["enter"]}}}),p(".everest-forms-panel-content-wrap").unblock()}})}else p.alert({title:m.i18n_field_title_empty,content:m.i18n_field_title_payload,icon:"dashicons dashicons-warning",type:"red",buttons:{ok:{text:m.i18n_ok,btnClass:"btn-confirm",keys:["enter"]}}})})},getStructure:function(){var e=p(".evf-admin-field-wrapper"),n=[];return p.each(e.find(".evf-admin-row"),function(){var e=p(this),o=e.attr("data-row-id");p.each(e.find(".evf-admin-grid"),function(){var e=p(this),i=e.attr("data-grid-id"),s=0;p.each(e.find(".everest-forms-field"),function(){var e={name:"",value:""},t=p(this).attr("data-field-id");e.name="structure[row_"+o+"][grid_"+i+"]["+s+"]",s++,e.value=t,n.push(e)}),e.find(".everest-forms-field").length<1&&n.push({name:"structure[row_"+o+"][grid_"+i+"]",value:""})})}),n},getFieldArray:function(e){var t=[];return p.each(e.find(".everest-forms-field"),function(){var e=p(this).attr("data-field-id");t.push(e)}),t},checkEmptyGrid:function(e){p.each(p(".evf-admin-grid"),function(){p(this).find(".everest-forms-field, .evf-registered-item:not(.ui-draggable-dragging)").not(".ui-sortable-helper").length<1?p(this).addClass("evf-empty-grid"):p(this).removeClass("evf-empty-grid")}),u.choicesInit()},bindDefaultTabs:function(){p(document).on("click",".evf-nav-tab-wrapper a",function(e){e.preventDefault(),u.switchTab(p(this).data("panel"))})},switchTab:function(e){var t=p("#everest-forms-panel-"+e),i=p(".evf-panel-"+e+"-button");p(".evf-nav-tab-wrapper").find("a").removeClass("nav-tab-active"),i.addClass("nav-tab-active"),t.closest(".evf-tab-content").find(".everest-forms-panel").removeClass("active"),t.addClass("active"),"integrations"!==e&&"payments"!==e||(t.find(".everest-forms-panel-sidebar a").hasClass("active")||t.find(".everest-forms-panel-sidebar a").first().addClass("active"),p(".everest-forms-panel-content").find(".evf-panel-content-section").hasClass("active")||p(".everest-forms-panel-content").find(".evf-panel-content-section").first().addClass("active")),history.replaceState({},null,u.updateQueryString("tab",e)),u.switchPanel(e)},updateQueryString:function(e,t,i){i=i||window.location.href;var s=new RegExp("([?&])"+e+"=.*?(&|#|$)(.*)","gi");if(s.test(i))return null!=t?i.replace(s,"$1"+e+"="+t+"$2$3"):(i=(o=i.split("#"))[0].replace(s,"$1$3").replace(/(&|\?)$/,""),"undefined"!=typeof o[1]&&null!==o[1]&&(i+="#"+o[1]),i);if(null==t)return i;var o,n=-1!==i.indexOf("?")?"&":"?";return i=(o=i.split("#"))[0]+n+e+"="+t,"undefined"!=typeof o[1]&&null!==o[1]&&(i+="#"+o[1]),i},switchPanel:function(e){"field-options"===e&&u.switchToFieldOptionPanel()},switchToFieldOptionPanel:function(e){p(".everest-forms-field-options").find(".no-fields").hide(),p(".evf-admin-field-wrapper .everest-forms-field").removeClass("active"),p("#everest-forms-panel-fields").addClass("active"),p(".everest-forms-fields-tab").find("a").removeClass("active"),p(".everest-forms-fields-tab").find("a").last().addClass("active"),p(".everest-forms-add-fields").hide(),p(".everest-forms-field-options").show(),p(".everest-forms-field-options").find(".everest-forms-field-option").hide(),p(".evf-tab-lists").find("li a").removeClass("active"),p(".evf-tab-lists").find("li.evf-panel-field-options-button a").addClass("active"),p(document.body).trigger("evf-init-switch-field-options"),void 0!==e?(p("#everest-forms-field-option-"+e).show(),p("#everest-forms-field-"+e).addClass("active")):0<p(".evf-admin-field-wrapper .everest-forms-field").length?(p(".evf-admin-field-wrapper .everest-forms-field").eq(0).addClass("active"),p("#everest-forms-field-option-"+p(".evf-admin-field-wrapper .everest-forms-field").eq(0).attr("data-field-id")).show()):p(".everest-forms-field-options").find(".no-fields").show()},bindFields:function(){p(".evf-admin-field-wrapper").sortable({items:".evf-admin-row",axis:"y",cursor:"move",opacity:.65,scrollSensitivity:40,forcePlaceholderSize:!0,placeholder:"evf-sortable-placeholder",containment:".everest-forms-panel-content",start:function(e,t){t.item.css({"background-color":"#f7fafc",border:"1px dashed #5d96ee"})},stop:function(e,t){t.item.removeAttr("style")}}).disableSelection(),p(".evf-admin-grid").sortable({items:"> .everest-forms-field",delay:100,opacity:.65,cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,connectWith:".evf-admin-grid",containment:".everest-forms-field-wrap",out:function(e){p(".evf-admin-grid").removeClass("evf-hover"),p(e.target).removeClass("evf-item-hover"),p(e.target).closest(".evf-admin-row").removeClass("evf-hover"),u.checkEmptyGrid()},over:function(e,t){p(".evf-admin-grid").addClass("evf-hover"),p(e.target).addClass("evf-item-hover"),p(e.target).closest(".evf-admin-row").addClass("evf-hover"),u.checkEmptyGrid()},receive:function(e,t){t.sender.is("button")&&u.fieldDrop(t.helper)},stop:function(e,t){t.item.removeAttr("style"),u.checkEmptyGrid()}}).disableSelection(),p(".evf-registered-buttons button.evf-registered-item").draggable({delay:200,cancel:!1,scroll:!1,revert:"invalid",scrollSensitivity:40,forcePlaceholderSize:!0,helper:function(){return p(this).clone().insertAfter(p(this).closest(".everest-forms-tab-content").siblings(".everest-forms-fields-tab"))},opacity:.75,containment:"#everest-forms-builder",connectToSortable:".evf-admin-grid"}).disableSelection(),p(".evf-admin-row").on("mouseenter mouseleave",function(e){e.buttons<1&&("mouseenter"===e.type?p(this).addClass("evf-hover"):p(".evf-admin-row").removeClass("evf-hover"))}),p(".everest-forms-panel-content").on("scroll",function(){p(".evf-admin-grid").sortable("refreshPositions"),p(".evf-admin-field-wrapper").sortable("refreshPositions")})},fieldTabChoice:function(e){p(".everest-forms-tab-content").scrollTop(0),p(".everest-forms-fields-tab a").removeClass("active"),p(".everest-forms-field, .everest-forms-title-desc").removeClass("active"),p("#"+e).addClass("active"),"add-fields"===e?(p(".everest-forms-add-fields").show(),p(".everest-forms-field-options").hide()):("field-options"===e?(e=p(".everest-forms-field").first().data("field-id"),p(".everest-forms-field-options").show(),p(".everest-forms-field").first().addClass("active")):p("#everest-forms-field-"+e).addClass("active"),p(".everest-forms-field-option").hide(),p("#everest-forms-field-option-"+e).show(),p(".everest-forms-add-fields").hide())},bindFormPreview:function(){},bindGridSwitcher:function(){p("body").on("click",".evf-show-grid",function(e){e.stopPropagation(),u.checkEmptyGrid(),p(this).closest(".evf-toggle-row").find(".evf-toggle-row-content").stop(!0).slideToggle(200)}),p(document).on("click",function(){u.checkEmptyGrid(),p(".evf-show-grid").closest(".evf-toggle-row").find(".evf-toggle-row-content").stop(!0).slideUp(200)});p("body").on("click",".evf-grid-selector",function(){var e=p(this).closest(".evf-admin-row");if(!p(this).hasClass("active")){var t=parseInt(p(this).attr("data-evf-grid"),10);if(!(2<t)){var i=p('<div class="evf-admin-grid evf-grid-'+t+' ui-sortable evf-empty-grid" />'),s=p("<div/>");p.each(e.find(".evf-admin-grid"),function(){p(this).children("*").each(function(){s.append(p(this).clone())})}),e.find(".evf-admin-grid").remove(),e.find(".evf-clear ").remove(),e.append('<div class="clear evf-clear"></div>');for(var o=1;o<=t;o++)i.attr("data-grid-id",o),e.append(i.clone());e.append('<div class="clear evf-clear"></div>'),e.find(".evf-admin-grid").eq(0).append(s.html()),e.find(".evf-grid-selector").removeClass("active"),p(this).addClass("active"),u.bindFields()}}})},fieldDrop:function(r){var e=r.attr("data-field-type");r.css({left:"0",width:"100%"}).append('<i class="spinner is-active"></i>'),p.ajax({url:m.ajax_url,type:"POST",data:{action:"everest_forms_new_field_"+e,security:m.evf_field_drop_nonce,field_type:e,form_id:m.form_id},beforeSend:function(){p(document.body).trigger("init_field_options_toggle")},success:function(e){var t=e.data.preview,i=e.data.options,s=e.data.form_field_id,o=e.data.field.type,n=p(t).attr("id"),a=p(t).attr("data-field-id");p("#everest-forms-field-id").val(s),p(".everest-forms-field-options").find(".no-fields").hide(),p(".everest-forms-field-options").append(i),p(".everest-forms-field-option-row-icon_color input.colorpicker").wpColorPicker({change:function(e){var t=p(this),i=t.val(),s=t.closest(".everest-forms-field-option-row").data("field-id");p("#everest-forms-field-"+s+" .rating-icon svg").css("fill",i)}}),r.after(t),null!==p("#everest-forms-panel-field-settings-enable_survey")&&p("#everest-forms-panel-field-settings-enable_survey").prop("checked")&&p("#everest-forms-field-option-"+a+"-survey_status").prop("checked",!0),null!==p("#everest-forms-panel-field-settings-enable_quiz")&&p("#everest-forms-panel-field-settings-enable_quiz").prop("checked")&&(p("#everest-forms-field-option-"+a+"-quiz_status").prop("checked",!0),p("#everest-forms-field-option-"+a+"-quiz_status").closest(".everest-forms-field-option-row-quiz_status").siblings(".everst-forms-field-quiz-settings").removeClass("everest-forms-hidden").addClass("everest-forms-show")),r.remove(),u.checkEmptyGrid(),p(document.body).trigger("init_tooltips"),p(document.body).trigger("init_field_options_toggle"),p(document.body).trigger("evf_after_field_append",[n]),u.conditionalLogicAppendField(n),u.conditionalLogicAppendFieldIntegration(n),u.paymentFieldAppendToQuantity(n),u.paymentFieldAppendToDropdown(a,o),u.init_datepickers(),p(document.body).trigger("evf_field_drop_complete",[o,a,t,i])}})},conditionalLogicAppendField:function(a){var e=p("#"+a),r=e.index(),d=p(".evf-field-conditional-field-select"),l=e.attr("data-field-type"),f=e.attr("data-field-id"),c=e.find(".label-title .text ").text();p.fn.insertAt=function(e,t,i){var s=p.makeArray(this.children().clone(!0));s.splice(t,0,e),p.each(s,function(e,t){i===p(t)[0].value&&(p(t)[0].selected=!0,s[e]=t)}),this.empty().append(s)};var v=f;d.each(function(s,e){var t,i=p(e).val(),o=a.replace("everest-forms-field-",""),n=p(e).attr("name");o===n.substring(n.indexOf("[")+1,n.indexOf("]"))?p(".evf-admin-row .evf-admin-grid .everest-forms-field").each(function(){var e=p(this).data("field-type"),t=p(this).data("field-id"),i=p(this).find(".label-title span").first().text();field_to_be_restricted=[],field_to_be_restricted=["html","title","address","image-upload","file-upload","date-time","hidden","scale-rating","likert"],-1===p.inArray(e,field_to_be_restricted)&&v!==t&&d.eq(s).append('<option class="evf-conditional-fields" data-field_type="'+e+'" data-field_id="'+t+'" value="'+t+'">'+i+"</option>")}):(t='<option class="evf-conditional-fields" data-field_type="'+l+'" data-field_id="'+f+'" value="'+f+'">'+c+"</option>","html"!==l&&"title"!==l&&"address"!==l&&"image-upload"!==l&&"file-upload"!==l&&"date-time"!==l&&"hidden"!==l&&"likert"!==l&&"scale-rating"!==l&&d.eq(s).insertAt(t,r,i))})},paymentFieldAppendToQuantity:function(e){var t=p("#"+e),i=p(".everest-forms-field-option-row-map_field select"),s=t.attr("data-field-type"),o='<option value="'+t.attr("data-field-id")+'">'+t.find(".label-title .text ").text()+"</option>";"payment-single"!==s&&"payment-multiple"!==s&&"payment-checkbox"!==s||i.append(o)},paymentFieldAppendToDropdown:function(e,t){var i;"payment-quantity"===t&&(i=p("#everest-forms-field-option-"+e+"-map_field"),["payment-checkbox","payment-multiple","payment-single"].forEach(function(e){p(".everest-forms-field-"+e).each(function(){var e='<option value="'+p(this).attr("data-field-id")+'">'+p(this).find(".label-title .text").text()+"</option>";i.append(e)})}))},conditionalLogicAppendFieldIntegration:function(n){var a=p("#"+n),r=a.index(),d=p(".evf-provider-conditional").find(".evf-conditional-field-select"),l=a.attr("data-field-type"),f=a.attr("data-field-id"),c=a.find(".label-title .text ").text();p.fn.insertAt=function(e,t){var i=p.makeArray(this.children().clone(!0));i.splice(t,0,e),this.empty().append(i)},d.each(function(s,e){var t,i=n.replace("everest-forms-field-",""),o=p(e).attr("name");i===o.substring(o.indexOf("[")+1,o.indexOf("]"))?p(".evf-admin-row .evf-admin-grid .everest-forms-field").each(function(){var e=p(this).data("field-type"),t=p(this).data("field-id"),i=p(this).find(".label-title span").first().text();field_to_be_restricted=[],field_to_be_restricted=["html","title","address","image-upload","file-upload","date-time","hidden","scale-rating","likert",a.attr("data-field-type")],-1===p.inArray(e,field_to_be_restricted)&&d.eq(s).append('<option class="evf-conditional-fields" data-field_type="'+e+'" data-field_id="'+t+'" value="'+t+'">'+i+"</option>")}):(t='<option class="evf-conditional-fields" data-field_type="'+l+'" data-field_id="'+f+'" value="'+f+'">'+c+"</option>","html"!==l&&"title"!==l&&"address"!==l&&"image-upload"!==l&&"file-upload"!==l&&"date-time"!==l&&"hidden"!==l&&"likert"!==l&&"scale-rating"!==l&&d.eq(s).insertAt(t,r))})},conditionalLogicRemoveField:function(e){p(".evf-field-conditional-field-select option[value = "+e+" ]").remove()},conditionalLogicRemoveFieldIntegration:function(e){p(".evf-provider-conditional .evf-conditional-field-select option[value = "+e+" ]").remove()},paymentFieldRemoveFromQuantity:function(e){p(".everest-forms-field-option-row-map_field select option[value = "+e+" ]").remove()},bindFieldSettings:function(){p("body").on("click",".everest-forms-preview .everest-forms-field, .everest-forms-preview .everest-forms-field .everest-forms-field-setting",function(e){e.preventDefault();var t=p(this).closest(".everest-forms-field").attr("data-field-id");p(".everest-forms-tab-content").scrollTop(0),u.switchToFieldOptionPanel(t)})},toggleLabelEdit:function(e,t){p(e).toggleClass("everest-forms-hidden"),p(t).toggleClass("everest-forms-hidden"),p(t).is(":visible")&&p(t).focus()},bindToggleHandleActions:function(){p("body").on("click",".toggle-handle",function(e){var t=p(this).data("label"),i=p(this).data("input");p(i).is(":visible")||u.toggleLabelEdit(t,i)})},bindLabelEditInputActions:function(){p("body").on("focusout",".label-edit-input",function(e){var t=p(this).data("label");u.toggleLabelEdit(t,this)})},bindSyncedInputActions:function(){p("body").on("input",".sync-input",function(e){var t=p(this).val(),i=p(this).data("sync-targets");t&&i&&p(i).text(t)})}};u.init()}(jQuery,window.evf_data),jQuery(function(){"checked"!=jQuery("#everest-forms-panel-field-settingsemail-evf_send_confirmation_email").attr("checked")&&jQuery("#everest-forms-panel-field-settingsemail-evf_send_confirmation_email-wrap").nextAll().hide(),jQuery("#everest-forms-panel-field-settingsemail-evf_send_confirmation_email").on("change",function(){"checked"!=jQuery(this).attr("checked")?jQuery("#everest-forms-panel-field-settingsemail-evf_send_confirmation_email-wrap").nextAll().hide():jQuery("#everest-forms-panel-field-settingsemail-evf_send_confirmation_email-wrap").nextAll().show()});var e=jQuery("#everest-forms-panel-field-settings-redirect_to option:selected").val();"same"==e?(jQuery("#everest-forms-panel-field-settings-custom_page-wrap").hide(),jQuery("#everest-forms-panel-field-settings-external_url-wrap").hide()):"custom_page"==e?(jQuery("#everest-forms-panel-field-settings-custom_page-wrap").show(),jQuery("#everest-forms-panel-field-settings-external_url-wrap").hide()):"external_url"==e&&(jQuery("#everest-forms-panel-field-settings-external_url-wrap").show(),jQuery("#everest-forms-panel-field-settings-custom_page-wrap").hide()),jQuery("#everest-forms-panel-field-settings-redirect_to").on("change",function(){"same"==this.value?(jQuery("#everest-forms-panel-field-settings-custom_page-wrap").hide(),jQuery("#everest-forms-panel-field-settings-external_url-wrap").hide()):"custom_page"==this.value?(jQuery("#everest-forms-panel-field-settings-custom_page-wrap").show(),jQuery("#everest-forms-panel-field-settings-external_url-wrap").hide()):"external_url"==this.value&&(jQuery("#everest-forms-panel-field-settings-custom_page-wrap").hide(),jQuery("#everest-forms-panel-field-settings-external_url-wrap").show())}),jQuery(".evf-panel-field-options-button.evf-disabled-tab").hide()}),jQuery(function(l){l(document.body).on("init_add_fields_toogle",function(){l(".everest-forms-add-fields").on("click",".everest-forms-add-fields-group > a",function(e){e.preventDefault(),l(this).parent(".everest-forms-add-fields-group").toggleClass("closed").toggleClass("open")}),l(".everest-forms-add-fields").on("click",".everest-forms-add-fields-group a",function(){l(this).next(".evf-registered-buttons").stop().slideToggle()}),l(".everest-forms-add-fields-group.closed").each(function(){l(this).find(".evf-registered-buttons").hide()})}).trigger("init_add_fields_toogle"),l(document.body).on("click",".everest-forms-field-option .everest-forms-field-option-group > a",function(e){e.preventDefault(),l(this).parent(".everest-forms-field-option-group").toggleClass("closed").toggleClass("open")}),l(document.body).on("click",".everest-forms-field-option .everest-forms-field-option-group a",function(e){l(e.target).filter(":input, option, .sort").length||l(this).next(".everest-forms-field-option-group-inner").stop().slideToggle()}),l(document.body).on("init_field_options_toggle",function(){l(".everest-forms-field-option-group.closed").each(function(){l(this).find(".everest-forms-field-option-group-inner").hide()})}).trigger("init_field_options_toggle"),l(document).on("click",function(){l(".evf-smart-tag-lists").hide()}),l(document.body).on("click",".evf-toggle-smart-tag-display",function(e){e.stopPropagation(),l(".evf-smart-tag-lists").hide(),l(".evf-smart-tag-lists ul").empty(),l(this).parent().find(".evf-smart-tag-lists").toggle("show");var t=l(this).data("type");!function(o,e,t){var n=[],a=[],r=[];if(l(".evf-admin-row .evf-admin-grid .everest-forms-field").each(function(){var e,t,i=l(this).data("field-type"),s=l(this).data("field-id");o===i?(e=l(this).find(".label-title span").first().text(),r[s]=e):(t=l(this).find(".label-title span").first().text(),n[s]=t),a[s]=l(this).find(".label-title span").first().text()}),"other"===e||"all"===e){var i=evf_data.smart_tags_other;for(var s in i)l(t).parent().find(".evf-smart-tag-lists .evf-others").append('<li class = "smart-tag-field" data-type="other" data-field_id="'+s+'">'+i[s]+"</li>")}if("fields"===e||"all"===e)if("email"===o)for(var s in Object.keys(r).length<1?l(t).parent().find('.evf-smart-tag-lists .smart-tag-title:not(".other-tag-title")').addClass("everest-forms-hidden"):l(t).parent().find('.evf-smart-tag-lists .smart-tag-title:not(".other-tag-title")').removeClass("everest-forms-hidden"),l(t).parent().find(".evf-smart-tag-lists .other-tag-title").remove(),l(t).parent().find(".evf-smart-tag-lists .evf-others").remove(),l(t).parent().find(".evf-smart-tag-lists").append('<div class="smart-tag-title other-tag-title">Others</div><ul class="evf-others"></ul>'),l(t).parent().find(".evf-smart-tag-lists .evf-others").append('<li class="smart-tag-field" data-type="other" data-field_id="admin_email">Site Admin Email</li><li class="smart-tag-field" data-type="other" data-field_id="user_email">User Email</li>'),r)l(t).parent().find(".evf-smart-tag-lists .evf-fields").append('<li class = "smart-tag-field" data-type="field" data-field_id="'+s+'">'+r[s]+"</li>");else for(var d in Object.keys(a).length<1?l(t).parent().find('.evf-smart-tag-lists .smart-tag-title:not(".other-tag-title")').addClass("everest-forms-hidden"):l(t).parent().find('.evf-smart-tag-lists .smart-tag-title:not(".other-tag-title")').removeClass("everest-forms-hidden"),a)l(t).parent().find(".evf-smart-tag-lists .evf-fields").append('<li class = "smart-tag-field" data-type="field" data-field_id="'+d+'">'+a[d]+"</li>")}(l(this).data("fields"),t,l(this))}),l(document.body).on("click",".smart-tag-field",function(e){var t=l(this).data("field_id"),i=l(this).text(),s=l(this).data("type"),o=l(this).parent().parent().parent(),n=o.find("input[type=text]"),a=o.find("textarea");if("fullname"!==t&&"email"!==t&&"subject"!==t&&"message"!==t&&"other"!==s){i=i.split(/[\s-_]/);for(var r=0;r<i.length;r++)i[r]=0===r?i[r].charAt(0).toLowerCase()+i[r].substr(1):i[r].charAt(0).toUpperCase()+i[r].substr(1);t=(i=i.join(""))+"_"+t}"field"===s?(n.val(n.val()+'{field_id="'+t+'"}'),a.val(a.val()+'{field_id="'+t+'"}')):"other"===s&&(n.val(n.val()+"{"+t+"}"),a.val(a.val()+"{"+t+"}"))}),l(document).on("change",".wp-list-table .everest-forms-toggle-form input",function(e){e.stopPropagation(),l.post(evf_data.ajax_url,{action:"everest_forms_enabled_form",security:evf_data.evf_enabled_form,form_id:l(this).data("form_id"),enabled:l(this).prop("checked")?1:0})}),l(document).on("change",".evf-content-email-settings .evf-toggle-switch input",function(e){var t=l(this),i=t.prop("checked");!1===i?(l(this).closest("#everest-forms-panel-settings").find(".everest-forms-active-email").addClass("everest-forms-hidden"),t.closest(".evf-content-email-settings").find(".email-disable-message").remove(),t.closest(".evf-content-section-title").siblings(".evf-content-email-settings-inner").addClass("everest-forms-hidden"),l('<p class="email-disable-message everest-forms-notice everest-forms-notice-info">'+evf_data.i18n_email_disable_message+"</p>").insertAfter(t.closest(".evf-content-section-title"))):!0===i&&(l(this).closest("#everest-forms-panel-settings").find(".everest-forms-active-email").removeClass("everest-forms-hidden"),t.closest(".evf-content-section-title").siblings(".evf-content-email-settings-inner").removeClass("everest-forms-hidden"),t.closest(".evf-content-email-settings").find(".email-disable-message").remove())}),l(document).on("click",".everest-forms-min-max-date-format input",function(){l(this).is(":checked")?l(".everest-forms-min-max-date-option").removeClass("everest-forms-hidden"):l(".everest-forms-min-max-date-option").addClass("everest-forms-hidden")})});