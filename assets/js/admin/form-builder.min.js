!function(m,u){var l,h={init:function(){m(document).ready(function(e){e("evf-panel-integrations-button a").hasClass("active")||(e("#everest-forms-panel-integrations").find(".everest-forms-panel-sidebar a").first().addClass("active"),e("#everest-forms-panel-integrations").find(".everest-forms-panel-sidebar a").hasClass("active")&&e("#everest-forms-panel-integrations").find(".everest-forms-panel-sidebar a").next(".everest-forms-active-connections").first().addClass("active"),e(".everest-forms-panel-content").find(".evf-panel-content-section").first().addClass("active"))}),m(document).ready(function(o){"1"===o(".everest-forms-min-max-date-format input").val()&&o(".everest-forms-min-max-date-option").find("input").datepicker({defaultDate:"",dateFormat:"yy-mm-dd",numberOfMonths:1,showButtonPanel:!0,onSelect:function(){var e=o(this).is(".everest-forms-min-date")?"minDate":"maxDate",t=o(this).closest(".everest-forms-min-max-date-option").find("input"),i=o(this).datepicker("getDate");t.not(this).datepicker("option",e,i),o(this).change()}}),o("evf-panel-payments-button a").hasClass("active")||(o("#everest-forms-panel-payments").find(".everest-forms-panel-sidebar a").first().addClass("active"),o(".everest-forms-panel-content").find(".evf-payment-setting-content").first().addClass("active"))}),m(document.body).on("click","#copy-shortcode",this.copyShortcode).on("aftercopy","#copy-shortcode",this.copySuccess).on("aftercopyfailure","#copy-shortcode",this.copyFail),m(document).ready(h.ready),m(window).on("load",h.load),m(document.body).on("evf-init-builder-fields",function(){h.bindFields()}).trigger("evf-init-builder-fields"),m(document.body).on("adjust_builder_width",function(){var e=m("#adminmenuwrap").width();m("#everest-forms-builder-form").css({width:"calc(100% - "+e+"px)"})}).trigger("adjust_builder_width"),m(document.body).on("click","#collapse-button",function(){m("#everest-forms-builder-form").width(""),m(document.body).trigger("adjust_builder_width")}),m(window).on("resize orientationchange",function(){var e;clearTimeout(e),e=setTimeout(function(){m("#everest-forms-builder").width(""),m(document.body).trigger("adjust_builder_width")},250)}).trigger("resize")},copyShortcode:function(e){evfClearClipboard(),evfSetClipboard(m(".evf-shortcode-field").find("input").val(),m(this)),e.preventDefault()},copySuccess:function(){m("#copy-shortcode").tooltipster("content",m(this).attr("data-copied")).trigger("mouseenter").on("mouseleave",function(){var e=m(this);setTimeout(function(){e.tooltipster("content",e.attr("data-tip"))},1e3)})},copyFail:function(){m(".evf-shortcode-field").find("input").focus().select()},load:function(){m(".everest-forms-overlay").fadeOut()},ready:function(){if(l=m("#everest-forms-builder"),h.bindUIActions(),h.bindEditActions(),jconfirm.defaults={closeIcon:!0,backgroundDismiss:!0,escapeKey:!0,animationBounce:1,useBootstrap:!1,theme:"modern",boxWidth:"400px",columnClass:"evf-responsive-class"},"undefined"!=typeof PerfectScrollbar){var e=m(".everest-forms-tab-content"),t=m("#everest-forms-panel-settings .everest-forms-panel-sidebar");1<=e.length&&(window.evf_tab_scroller=new PerfectScrollbar(e.selector,{suppressScrollX:!0})),1<=t.length&&(window.evf_setting_scroller=new PerfectScrollbar(t.selector))}l.on("change",".everest-forms-field-option-row-limit_enabled input",function(e){h.updateTextFieldsLimitControls(m(e.target).parents(".everest-forms-field-option-row-limit_enabled").data().fieldId,e.target.checked)}),m(document).trigger("everest_forms_ready")},updateTextFieldsLimitControls:function(e,t){t?m("#everest-forms-field-option-row-"+e+"-limit_controls").removeClass("everest-forms-hidden"):m("#everest-forms-field-option-row-"+e+"-limit_controls").addClass("everest-forms-hidden")},bindUIActions:function(){h.bindDefaultTabs(),h.checkEmptyGrid(),h.bindFields(),h.bindFormPreview(),h.bindGridSwitcher(),h.bindFieldSettings(),h.bindFieldDelete(),h.bindCloneField(),h.bindSaveOption(),h.bindAddNewRow(),h.bindRemoveRow(),h.bindFormSettings(),h.bindFormEmail(),h.bindFormIntegrations(),h.bindFormPayment(),h.choicesInit(),h.bindToggleHandleActions(),h.bindLabelEditInputActions(),h.bindSyncedInputActions(),h.initializeRangeSliderFields(),h.init_datepickers(),h.bindUIActionsFields(),"field-options"===u.tab&&m(".evf-panel-field-options-button").trigger("click")},init_datepickers:function(){var e=m(".everest-forms-disable-dates").data("date-format");m(".everest-forms-disable-dates").each(function(){m(this).get(0)._flatpickr||m(this).flatpickr({dateFormat:e,mode:"multiple"})}),m(document.body).on("change",".evf-date-format",function(e){var t=m(".everest-forms-field-option:visible .everest-forms-disable-dates"),i=t.get(0)._flatpickr,o=i.selectedDates,s=m(this).val(),n=[];o.forEach(function(e){n.push(flatpickr.formatDate(e,s))}),i.set("dateFormat",s),t.val(n.join(", "))}),m(document.body).on("click",".evf-clear-disabled-dates",function(){m(".everest-forms-field-option:visible .everest-forms-disable-dates").get(0)._flatpickr.clear()})},initializeRangeSliderFields:function(){m(document.body).on("change",".everest-forms-field-option .evf-range-slider-skin",h.updateRangeSliderBasicOptions),m(document.body).on("input",".everest-forms-field-option .everest-forms-field-option-row-min_value .evf-input-number",h.updateRangeSliderBasicOptions),m(document.body).on("input",".everest-forms-field-option .everest-forms-field-option-row-max_value .evf-input-number",h.updateRangeSliderBasicOptions),m(document.body).on("input",".everest-forms-field-option .everest-forms-field-option-row-min_max_values .evf-input-number",h.updateRangeSliderBasicOptions),m(document.body).on("change",".everest-forms-field-option .evf-range-slider-show-grid",h.updateRangeSliderBasicOptions),m(document.body).on("change",".everest-forms-field-option .evf-show-slider-prefix-postfix",h.updateRangeSliderBasicOptions),m(document.body).on("input",".everest-forms-field-option .everest-forms-field-option-row-default_value input",h.updateRangeSliderBasicOptions),m(document.body).on("change",".everest-forms-field-option .evf-use-text-prefix-postfix",h.updateRangeSliderBasicOptions),m(document.body).on("input",".everest-forms-field-option .evf-input-prefix-text, .everest-forms-field-option .evf-input-postfix-text",h.updateRangeSliderBasicOptions),m(document.body).on("change",".everest-forms-field-option .evf-show-slider-input",h.updateRangeSliderBasicOptions),m(".everest-forms-field.everest-forms-field-range-slider").each(function(e){var t=m(this).data("field-id");h.initializeRangeSliderField(t)})},initializeRangeSliderField:function(e){m("#everest-forms-field-"+e).find(".evf-range-slider-preview").ionRangeSlider(),h.initializeSliderHandleColorOption(e),h.initializeSliderHighlightColorOption(e),h.initializeSliderTrackColorOption(e),h.updateRangeSliderBasicOptions(e),h.updateRangeSliderColors(e)},initializeSliderHandleColorOption:function(e){var n=m("#everest-forms-field-option-"+e);n.find(".evf-range-slider-handle-color").wpColorPicker({change:function(e,t){var i=m(e.target).val(),o=m(this).closest(".everest-forms-field-option-row").data("field-id"),s=n.find(".evf-range-slider-skin").val();h.setSliderHandleColor(o,i,s)}})},initializeSliderHighlightColorOption:function(e){var o=m("#everest-forms-field-"+e);m("#everest-forms-field-option-"+e).find(".evf-range-slider-highlight-color").wpColorPicker({change:function(e,t){var i=m(e.target).val();i&&o.find(".irs-bar").css("background",i)}})},initializeSliderTrackColorOption:function(e){var o=m("#everest-forms-field-"+e);m("#everest-forms-field-option-"+e).find(".evf-range-slider-track-color").wpColorPicker({change:function(e,t){var i=m(e.target).val();i&&o.find(".irs-line").css("background",i)}})},updateRangeSliderColors:function(e){var t=m("#everest-forms-field-"+e),i=m("#everest-forms-field-option-"+e),o=i.find(".evf-range-slider-skin").val(),s=i.find(".evf-range-slider-handle-color").val(),n=i.find(".evf-range-slider-highlight-color").val(),r=i.find(".evf-range-slider-track-color").val();h.setSliderHandleColor(e,s,o),t.find(".irs-bar").css("background",n),t.find(".irs-line").css("background",r)},setSliderHandleColor:function(e,t,i){if(""!==e){var o=m("#everest-forms-field-"+e),s="";switch(i){case"flat":o.find(".irs-handle i").first().css("background-color",t),o.find(".irs-single").css("background-color",t),s="#everest-forms-field-"+e+" .irs-single:before { border-top-color: "+t+"!important; }";break;case"big":o.find(".irs-single").css("background-color",t),o.find(".irs-single").css("background",t),o.find(".irs-handle").css("background-color",t),o.find(".irs-handle").css("background",t);break;case"modern":o.find(".irs-handle i").css("background",t),o.find(".irs-single").css("background-color",t),s="#everest-forms-field-"+e+" .irs-single:before { border-top-color: "+t+"!important; }";break;case"sharp":o.find(".irs-handle").css("background-color",t),o.find(".irs-handle i").first().css("border-top-color",t),o.find(".irs-single").css("background-color",t),s="#everest-forms-field-"+e+" .irs-single:before { border-top-color: "+t+"!important; }";break;case"round":case"square":o.find(".irs-handle").css("border-color",t),o.find(".irs-single").css("background-color",t),s="#everest-forms-field-"+e+" .irs-single:before { border-top-color: "+t+"!important; }"}m("body").find(".evf-range-slider-handle-style-tag-"+e).remove(),m("body").append('<style class="evf-range-slider-handle-style-tag-'+e+'" >'+s+"</style>")}},updateRangeSliderBasicOptions:function(e){e="string"==typeof e?e:m(".everest-forms-field-option:visible").data("field-id");var t=m("#everest-forms-field-"+e),i=m("#everest-forms-field-option-"+e),o=m("#everest-forms-field-option-"+e+"-min_value").val(),s=m("#everest-forms-field-option-"+e+"-max_value").val(),n=m("#everest-forms-field-option-"+e+"-skin").val(),r=m("#everest-forms-field-option-"+e+"-default_value").val(),a=m("#everest-forms-field-option-"+e+"-show_grid").is(":checked"),d=m("#everest-forms-field-option-"+e+"-show_prefix_postfix").is(":checked"),l=m("#everest-forms-field-option-"+e+"-use_text_prefix_postfix").is(":checked"),f={};if(""!==o&&(f.min=o),""!==s&&(f.max=s),f.skin=""!==n?n:"round",""!==n&&(f.skin=n),f.grid=!!a,d?(f.hide_min_max=!1,m("#everest-forms-field-option-row-"+e+"-use_text_prefix_postfix").show(),m("#everest-forms-field-option-"+e).find(".evf-prefix-postfix-warning-message").show()):(f.hide_min_max=!0,m("#everest-forms-field-option-row-"+e+"-use_text_prefix_postfix").hide(),m("#everest-forms-field-option-"+e).find(".evf-prefix-postfix-warning-message").hide()),""!==r&&(f.from=r),m("#everest-forms-field-option-"+e+"-show_slider_input").is(":checked")?t.find(".evf-slider-input-wrapper").show():t.find(".evf-slider-input-wrapper").hide(),t.find("input.evf-range-slider-preview").data("ionRangeSlider").update(f),t.find(".evf-slider-input").val(r),d&&l){var c=i.find(".evf-input-prefix-text").val(),v=i.find(".evf-input-postfix-text").val();t.find("span.irs-min").html(c),t.find("span.irs-max").html(v),i.find(".evf-range-slider-prefix-postfix-texts").show()}else i.find(".evf-range-slider-prefix-postfix-texts").hide();h.updateRangeSliderColors(e)},bindEditActions:function(){m("#edit-form-name").on("click",function(e){e.stopPropagation(),""!==m("#evf-edit-form-name").val().trim()&&h.toggleEditTitle(e)}),m("#evf-edit-form-name").on("change keypress",function(e){var t=m(this);e.stopPropagation(),13===e.which&&""!==m(this).val().trim()&&h.toggleEditTitle(e),""!==t.val().trim()&&m("#everest-forms-panel-field-settings-form_title").val(t.val().trim())}).on("click",function(e){e.stopPropagation()}),m(document).not(m(".everest-forms-title-desc")).click(function(e){var t=m("#evf-edit-form-name");e.stopPropagation(),!t.prop("disabled")&&t.val()&&""!==t.val().trim()&&h.toggleEditTitle(e)})},toggleEditTitle:function(e){var t=m("#edit-form-name").siblings("#evf-edit-form-name");e.preventDefault(),t.prop("disabled",function(e,t){return!t}),t.hasClass("everst-forms-name-editing")||t.focus(),t.toggleClass("everst-forms-name-editing")},formObject:function(e){for(var t=jQuery(e).find("[name]"),i={},o={},s=0;s<t.length;s++){var n=jQuery(t[s]),r=n.prop("name").replace(/\]/gi,"").split("["),a=n.val(),d={};if(!n.is(":radio")&&!n.is(":checkbox")||n.is(":checked")){for(var l=r.length-1;0<=l;l--){var f=r[l];if(void 0===f&&(f=""),0===f.length&&(d=[],"undefined"==typeof o[r[l-1]]?o[r[l-1]]=0:o[r[l-1]]+=1,f=o[r[l-1]]),l===r.length-1){if(a)if("true"===a)a=!0;else if("false"===a)a=!1;else if(isNaN(parseFloat(a))||parseFloat(a).toString()!==a)if("string"!=typeof a||"{"!==a.substr(0,1)&&"["!==a.substr(0,1)){if("object"==typeof a&&a.length&&n.is("select")){var c={};for(l=0;l<a.length;l++)c["n"+l]=a[l];a=c}}else try{a=JSON.parse(a)}catch(p){}else a=parseFloat(a);d[f]=a}else{var v=d;(d={})[f]=v}}m.extend(!0,i,d)}}return i},bindUIActionsFields:function(){l.on("click",".everest-forms-field-option-row-choices .add",function(e){h.choiceAdd(e,m(this))}),l.on("click",".everest-forms-field-option-row-choices .remove",function(e){h.choiceDelete(event,m(this))}),l.on("mousedown",".everest-forms-field-option-row-choices input[type=radio]",function(e){var t=m(this);t.is(":checked")?t.attr("data-checked","1"):t.attr("data-checked","0")}),l.on("click",".everest-forms-field-option-row-choices input[type=radio]",function(e){var t=m(this),i=t.parent().parent();t.parent().parent().find("input[type=radio]").not(this).prop("checked",!1),"1"===t.attr("data-checked")&&(t.prop("checked",!1),t.attr("data-checked","0")),h.choiceUpdate(i.data("field-type"),i.data("field-id"))}),l.on("change",".everest-forms-field-option-row-choices input[type=checkbox]",function(e){var t=m(this).parent().parent();h.choiceUpdate(t.data("field-type"),t.data("field-id"))}),l.on("keyup paste focusout",".everest-forms-field-option-row-choices input.label",function(e){var t=m(this).parent().parent().parent();h.choiceUpdate(t.data("field-type"),t.data("field-id"))}),l.on("change",".everest-forms-field-option-row-show_values input",function(e){m(this).closest(".everest-forms-field-option").find(".everest-forms-field-option-row-choices ul").toggleClass("show-values")}),l.on("change",".everest-forms-field-option-row-choices_images input",function(){var e=m(this),t=e.parent().data("field-id"),i=m("#everest-forms-field-option-"+t),o=m("#everest-forms-field-option-"+t+"-input_columns"),s=m("#everest-forms-field-option-"+t).find(".everest-forms-field-option-hidden-type").val();e.parent().find(".notice").toggleClass("hidden"),i.find(".everest-forms-field-option-row-choices ul").toggleClass("show-images"),e.is(":checked")?o.val("inline").trigger("change"):o.val("").trigger("change"),h.choiceUpdate(s,t)}),l.on("click",".everest-forms-attachment-media-view .upload-button",function(e){var t,i,o=m(this);e.preventDefault(),i||(i=wp.media.frames.everestforms_media_frame=wp.media({title:u.i18n_upload_image_title,className:"media-frame everest-forms-media-frame",frame:"select",multiple:!1,library:{type:"image"},button:{text:u.i18n_upload_image_button}})).on("select",function(){var e=i.state().get("selection").first().toJSON();(t=o.hasClass("button-add-media")?(o.hide(),o.parent()):o.parent().parent().parent()).find(".source").val(e.url),t.find(".attachment-thumb").remove(),t.find(".thumbnail-image").prepend('<img class="attachment-thumb" src="'+e.url+'">'),t.find(".actions").show(),l.trigger("everestFormsImageUploadAdd",[o,t])}),i.open()}),l.on("click",".everest-forms-attachment-media-view .remove-button",function(e){e.preventDefault();var t=m(this).parent().parent();t.find(".attachment-thumb").remove(),t.parent().find(".source").val(""),t.parent().find(".button-add-media").show(),l.trigger("everestFormsImageUploadRemove",[m(this),t])}),l.on("everestFormsImageUploadAdd everestFormsImageUploadRemove",function(e,t,i){var o=i.closest(".evf-choices-list"),s=o.data("field-type"),n=o.data("field-id");h.choiceUpdate(s,n)}),l.on("change",".everest-forms-field-option-row-input_columns select",function(){var e=m(this),t=e.val(),i=e.parent().data("field-id"),o="";"inline"===t?o="everest-forms-list-inline":""!==t&&(o="everest-forms-list-"+t+"-columns"),m("#everest-forms-field-"+i).removeClass("everest-forms-list-inline everest-forms-list-2-columns everest-forms-list-3-columns").addClass(o)}),l.on("click",".everest-forms-fields-tab a",function(e){e.preventDefault(),h.fieldTabChoice(m(this).attr("id"))}),l.on("change",".everest-forms-field-option-address input.hide",function(){var e=m(this),t=e.parent().parent().data("field-id"),i=e.parent().parent().data("subfield");m("#everest-forms-field-"+t).find(".everest-forms-"+i).toggleClass("hidden")}),l.on("input",".everest-forms-field-option-row-label input",function(){var e=m(this),t=e.val(),i=e.parent().data("field-id");$label=m("#everest-forms-field-"+i).find(".label-title .text"),$label.hasClass("nl2br")?$label.html(t.replace(/\n/g,"<br>")):$label.html(t)}),l.on("input",".everest-forms-field-option-row-description textarea",function(){var e=m(this),t=e.val(),i=e.parent().data("field-id"),o=m("#everest-forms-field-"+i).find(".description");o.hasClass("nl2br")?o.html(t.replace(/\n/g,"<br>")):o.html(t)}),l.on("change",".everest-forms-field-option-row-required input",function(e){var t=m(this).parent().data("field-id");m("#everest-forms-field-"+t).toggleClass("required"),m(e.target).is(":checked")?m("#everest-forms-field-option-row-"+t+"-required-field-message").show():m("#everest-forms-field-option-row-"+t+"-required-field-message").hide()}),l.on("change",".everest-forms-field-option-row-confirmation input",function(e){var t=m(this).parent().data("field-id");m(e.target).is(":checked")?(m("#everest-forms-field-"+t).find(".everest-forms-confirm").removeClass("everest-forms-confirm-disabled").addClass("everest-forms-confirm-enabled"),m("#everest-forms-field-option-"+t).removeClass("everest-forms-confirm-disabled").addClass("everest-forms-confirm-enabled")):(m("#everest-forms-field-"+t).find(".everest-forms-confirm").removeClass("everest-forms-confirm-enabled").addClass("everest-forms-confirm-disabled"),m("#everest-forms-field-option-"+t).removeClass("everest-forms-confirm-enabled").addClass("everest-forms-confirm-disabled"))}),l.on("input",".everest-forms-field-option-row-placeholder input",function(e){var t=m(this),i=t.val(),o=t.parent().data("field-id"),s=m("#everest-forms-field-"+o).find(".widefat:not(.secondary-input)");s.is("select")?i.length?s.find(".placeholder").length?s.find(".placeholder").text(i):s.prepend('<option class="placeholder" selected>'+i+"</option>"):s.find(".placeholder").remove():s.attr("placeholder",i)}),l.on("input",".everest-forms-field-option-address input.placeholder",function(e){var t=m(this),i=t.val(),o=t.parent().parent().data("field-id"),s=t.parent().parent().data("subfield");m("#everest-forms-field-"+o).find(".everest-forms-"+s+" input").attr("placeholder",i)}),l.on("input",".everest-forms-field-option-row-confirmation_placeholder input",function(){var e=m(this),t=e.val(),i=e.parent().data("field-id");m("#everest-forms-field-"+i).find(".secondary-input").attr("placeholder",t)}),l.on("change",".everest-forms-field-option-row-label_hide input",function(){var e=m(this).parent().data("field-id");m("#everest-forms-field-"+e).toggleClass("label_hide")}),l.on("change",".everest-forms-field-option-row-sublabel_hide input",function(){var e=m(this).parent().data("field-id");m("#everest-forms-field-"+e).toggleClass("sublabel_hide")}),l.on("change",".everest-forms-field-option-row-datetime_format select, .everest-forms-field-option-row-phone_format select, .everest-forms-field-option-row-item_price select, .everest-forms-field-option-row-format select",function(e){var t=m(this),i=t.val(),o=t.parent().data("field-id");m("#everest-forms-field-"+o).find(".format-selected").removeClass().addClass("format-selected format-selected-"+i),m("#everest-forms-field-option-"+o).find(".format-selected").removeClass().addClass("format-selected format-selected-"+i)})},choicesInit:function(e){m(e=e||".everest-forms-field-option-row-choices ul").sortable({items:"li",axis:"y",handle:".sort",scrollSensitivity:40,stop:function(e){var t=m(e.target).attr("data-field-id"),i=m("#everest-forms-field-option-"+t).find(".everest-forms-field-option-hidden-type").val();h.choiceUpdate(i,t)}})},choiceAdd:function(e,t){e.preventDefault();var i=m(t),o=i.parent(),s=o.find("input.default").is(":checked"),n=i.closest(".everest-forms-field-option-row-choices").data("field-id"),r=o.parent().attr("data-next-id"),a=o.parent().data("field-type"),d=o.clone().insertAfter(o);d.attr("data-key",r),d.find("input.label").val("").attr("name","form_fields["+n+"][choices]["+r+"][label]"),d.find("input.value").val("").attr("name","form_fields["+n+"][choices]["+r+"][value]"),d.find("input.source").val("").attr("name","form_fields["+n+"][choices]["+r+"][image]"),d.find("input.default").attr("name","form_fields["+n+"][choices]["+r+"][default]").prop("checked",!1),d.find(".attachment-thumb").remove(),d.find(".button-add-media").show(),!0===s&&o.find("input.default").prop("checked",!0),r++,o.parent().attr("data-next-id",r),l.trigger("everestFormsChoiceAdd"),h.choiceUpdate(a,n)},choiceDelete:function(e,t){e.preventDefault();var i=m(t),o=i.parent().parent();o.find("li").length<2?m.alert({title:!1,content:u.i18n_field_error_choice,icon:"dashicons dashicons-info",type:"blue",buttons:{ok:{text:u.i18n_ok,btnClass:"btn-confirm",keys:["enter"]}}}):(i.parent().remove(),h.choiceUpdate(o.data("field-type"),o.data("field-id")),l.trigger("everestFormsChoiceDelete"))},choiceUpdate:function(n,r){var a,e=m("#everest-forms-field-option-"+r);if("radio"===n||"checkbox"===n||"payment-multiple"===n||"payment-checkbox"===n){var t=[],i=h.formObject(e).form_fields[r];m("#everest-forms-field-option-"+r).find(".evf-choices-list li").each(function(){t.push(m(this).data("key"))});var o=wp.template("everest-forms-field-preview-choices");return data={type:n="checkbox"===n||"payment-checkbox"===n?"checkbox":"radio",order:t,settings:i},void m("#everest-forms-field-"+r).find("ul.primary-input").replaceWith(o(data))}"select"===n&&(m("#everest-forms-field-"+r+" .primary-input option").not(".placeholder").remove(),a="<option>{label}</option>"),m("#everest-forms-field-option-row-"+r+"-choices .evf-choices-list li").each(function(e){var t=m(this),i=t.find("input.label").val(),o=t.find("input.default").is(":checked"),s=m(a.replace("{label}",i));if(m("#everest-forms-field-"+r+" .primary-input").append(s),!0===o)switch(n){case"select":s.prop("selected",!0);break;case"radio":case"checkbox":s.find("input").prop("checked",!0)}})},bindFormSettings:function(){m("body").on("click",".evf-setting-panel",function(e){var t=m(this).attr("data-section");m(".evf-setting-panel").removeClass("active"),m(".everest-forms-active-email").removeClass("active"),m(".evf-content-section").removeClass("active"),m(this).addClass("active"),m(".evf-content-"+t+"-settings").addClass("active"),e.preventDefault()}),m(".evf-setting-panel").eq(0).trigger("click")},bindFormEmail:function(){m("body").on("click",".everest-forms-panel-sidebar-section-email",function(e){m(this).siblings(".everest-forms-active-email").removeClass("active"),m(this).next(".everest-forms-active-email").addClass("active");var t=m(this).siblings(".everest-forms-active-email.active").find(".everest-forms-active-email-connections-list li");t.length&&t.children(".user-nickname").first().trigger("click"),e.preventDefault()})},bindFormIntegrations:function(){m("body").on("click",".evf-integrations-panel",function(e){var t=m(this).attr("data-section");m(".evf-integrations-panel").removeClass("active"),m("#everest-forms-panel-integrations").find(".evf-panel-content-section").removeClass("active"),m(this).addClass("active"),m(this).parent().find(".everest-forms-active-connections").removeClass("active"),m(this).next(".everest-forms-active-connections").addClass("active");var i=m(this).siblings(".everest-forms-active-connections.active").find(".everest-forms-active-connections-list li");i.length&&i.children(".user-nickname").first().trigger("click"),m(".evf-panel-content-section-"+t).addClass("active"),e.preventDefault()}),m(".evf-setting-panel").eq(0).trigger("click")},bindFormPayment:function(){m("body").on("click",".evf-payments-panel",function(e){var t=m(this).attr("data-section");m(".evf-payments-panel").removeClass("active"),m(this).siblings().removeClass("icon active"),m(this).addClass("active"),m(this).parents("#everest-forms-panel-payments").find(".evf-payment-setting-content").removeClass("active").hide(),m(".evf-content-"+t+"-settings").addClass("active").show(),e.preventDefault()}),m(".evf-setting-panel").eq(0).trigger("click")},removeRow:function(e){m.each(e.find(".everest-forms-field"),function(){var e=m(this).attr("data-field-id"),t=m("#everest-forms-field-option-"+e);m(this).remove(),t.remove()}),e.remove()},bindRemoveRow:function(){m("body").on("click",".evf-delete-row",function(){var e=m(this),t=m(".evf-admin-row").length,i=e.closest(".evf-admin-row"),o=e.parents(".evf-admin-field-container").attr("data-current-part"),s=m("#everest-forms-builder").hasClass("multi-part-activated");o&&s&&(t=m("#part_"+o).find(".evf-admin-row").length),t<2?m.alert({title:u.i18n_row_locked,content:u.i18n_row_locked_msg,icon:"dashicons dashicons-info",type:"blue",buttons:{confirm:{text:u.i18n_close,btnClass:"btn-confirm",keys:["enter"]}}}):m.confirm({title:!1,content:u.i18n_delete_row_confirm,type:"red",closeIcon:!1,backgroundDismiss:!1,icon:"dashicons dashicons-warning",buttons:{confirm:{text:u.i18n_ok,btnClass:"btn-confirm",keys:["enter"],action:function(){h.removeRow(i)}},cancel:{text:u.i18n_cancel}}})})},bindAddNewRow:function(){m("body").on("click",".evf-add-row span",function(){var e=m(this),t=m(".evf-admin-field-wrapper"),i=m(".evf-admin-row").eq(0).clone(),o=e.parent().attr("data-total-rows"),s=e.parents(".evf-admin-field-container").attr("data-current-part");o++,s&&(t=m(".evf-admin-field-wrapper").find("#part_"+s)),i.find(".evf-admin-grid").html(""),i.attr("data-row-id",o),e.parent().attr("data-total-rows",o),t.append(i),h.bindFields(),h.checkEmptyGrid()})},bindCloneField:function(){m("body").on("click",".everest-forms-preview .everest-forms-field .everest-forms-field-duplicate",function(){var e=m(this).closest(".everest-forms-field");e.hasClass("no-duplicate")?m.alert({title:u.i18n_field_locked,content:u.i18n_field_locked_msg,icon:"dashicons dashicons-info",type:"blue",buttons:{confirm:{text:u.i18n_close,btnClass:"btn-confirm",keys:["enter"]}}}):m.confirm({title:!1,content:u.i18n_duplicate_field_confirm,type:"orange",closeIcon:!1,backgroundDismiss:!1,icon:"dashicons dashicons-warning",buttons:{confirm:{text:u.i18n_ok,btnClass:"btn-confirm",keys:["enter"],action:function(){h.cloneFieldAction(e)}},cancel:{text:u.i18n_cancel}}})})},cloneFieldAction:function(o){var s=o.attr("data-field-id"),e=u.form_id,t={action:"everest_forms_get_next_id",security:u.evf_get_next_id,form_id:e};m.ajax({url:u.ajax_url,data:t,type:"POST",beforeSend:function(){m(document.body).trigger("init_field_options_toggle")},success:function(e){if("boolean"==typeof e.success&&!0===e.success){var t=e.data.field_id,i=e.data.field_key;m("#everest-forms-field-id").val(t),h.render_node(o,s,i),m(document.body).trigger("init_field_options_toggle")}}})},render_node:function(e,s,n){var t=m(".everest-forms-field-options #everest-forms-field-option-"+s),i=m("#everest-forms-field-option-"+s+"-label").val(),o=m("#everest-forms-field-option-"+s+"-meta-key").length?m("#everest-forms-field-option-"+s+"-meta-key").val():"",r=e.attr("data-field-type"),a=t.html(),d=i+" "+u.i18n_copy,l="html"!==r?o.replace(/\(|\)/g,"").toLowerCase().substring(0,o.lastIndexOf("_"))+"_"+Math.floor(1e3+9e3*Math.random()):"",f=e.clone(),c=new RegExp(s,"g");a=a.replace(c,n);var v=m('<div class="everest-forms-field-option everest-forms-field-option-'+r+'" id="everest-forms-field-option-'+n+'" data-field-id="'+n+'" />');if(v.append(a),m.each(t.find(":input"),function(){var e=m(this).attr("type"),t=(m(this).attr("name")?m(this).attr("name"):"").replace(c,n),i="";if("text"===e||"hidden"===e)i=m(this).val(),v.find('input[name="'+t+'"]').val(i),v.find('input[value="'+s+'"]').val(n);else if("checkbox"===e||"radio"===e)m(this).is(":checked")?v.find('input[name="'+t+'"]').prop("checked",!0).attr("checked","checked"):v.find('[name="'+t+'"]').prop("checked",!1).attr("checked",!1);else if(m(this).is("select")){if(m(this).find("option:selected").length){var o=m(this).find("option:selected").val();v.find('[name="'+t+'"]').find('[value="'+o+'"]').prop("selected",!0)}}else""!==m(this).val()&&v.find('[name="'+t+'"]').val(m(this).val())}),m(".everest-forms-field-options").append(v),m("#everest-forms-field-option-"+n+"-label").val(d),m("#everest-forms-field-option-"+n+"-meta-key").val(l),f.attr("class",e.attr("class")),f.attr("id","everest-forms-field-"+n),f.attr("data-field-id",n),f.attr("data-field-type",r),f.find(".label-title .text").text(d),e.closest(".evf-admin-grid").find('[data-field-id="'+s+'"]').after(f),m(document).trigger("everest-form-cloned",[n,r]),h.switchToFieldOptionPanel(n),"range-slider"===r){var p="";f.find(".irs").remove(),f.find(".evf-slider .evf-range-slider-preview").hide(),p=v.find(".everest-forms-field-option-row-handle_color .wp-picker-input-wrap label").html(),v.find(".everest-forms-field-option-row-handle_color .wp-picker-container").remove(),v.find(".everest-forms-field-option-row-handle_color").append(p),p=v.find(".everest-forms-field-option-row-highlight_color .wp-picker-input-wrap label").html(),v.find(".everest-forms-field-option-row-highlight_color .wp-picker-container").remove(),v.find(".everest-forms-field-option-row-highlight_color").append(p),p=v.find(".everest-forms-field-option-row-track_color .wp-picker-input-wrap label").html(),v.find(".everest-forms-field-option-row-track_color .wp-picker-container").remove(),v.find(".everest-forms-field-option-row-track_color").append(p),h.initializeRangeSliderField(n)}},bindFieldDelete:function(){m("body").on("click",".everest-forms-preview .everest-forms-field .everest-forms-field-delete",function(){var t=m(this).closest(".everest-forms-field"),e=t.attr("data-field-id"),i=m("#everest-forms-field-option-"+e);m(this).closest(".evf-admin-grid");t.hasClass("no-delete")?m.alert({title:u.i18n_field_locked,content:u.i18n_field_locked_msg,icon:"dashicons dashicons-info",type:"blue",buttons:{confirm:{text:u.i18n_close,btnClass:"btn-confirm",keys:["enter"]}}}):m.confirm({title:!1,content:u.i18n_delete_field_confirm,type:"red",closeIcon:!1,backgroundDismiss:!1,icon:"dashicons dashicons-warning",buttons:{confirm:{text:u.i18n_ok,btnClass:"btn-confirm",keys:["enter"],action:function(){m(".evf-panel-fields-button").trigger("click"),t.fadeOut("slow",function(){var e=t.attr("data-field-id");m(document.body).trigger("evf_before_field_deleted",[e]),t.remove(),i.remove(),h.checkEmptyGrid(),m(".everest-forms-fields-tab").find("a").removeClass("active"),m(".everest-forms-fields-tab").find("a").first().addClass("active"),m(".everest-forms-add-fields").show(),h.conditionalLogicRemoveField(e),h.conditionalLogicRemoveFieldIntegration(e),h.paymentFieldRemoveFromQuantity(e)})}},cancel:{text:u.i18n_cancel}}})})},bindSaveOption:function(){m("body").on("click",".everest-forms-save-button",function(){var t=m(this),e=m("form#everest-forms-builder-form"),i=h.getStructure(),o=e.serializeArray();if(""!==m("#evf-edit-form-name").val().trim()){e.triggerHandler("everest_forms_process_ajax_data",[t,o])&&(o=e.triggerHandler("everest_forms_process_ajax_data",[t,o])),m(".everest-forms-panel-content-wrap").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var s=[];m(".everest-forms-field[data-field-id]").each(function(){s.push(m(this).attr("data-field-id"))});for(var n=o.length;n--;)if(o[n].name.startsWith("form_fields")){var r=!1;s.forEach(function(e){o[n].name.startsWith("form_fields["+e+"]")&&(r=!0)}),-1<n&&!1===r&&o.splice(n,1)}var a=o.concat(i),d={action:"everest_forms_save_form",security:u.evf_save_form,form_data:JSON.stringify(a)};m.ajax({url:u.ajax_url,data:d,type:"POST",beforeSend:function(){t.addClass("processing"),t.find(".loading-dot").remove(),t.append('<span class="loading-dot"></span>')},success:function(e){t.removeClass("processing"),t.find(".loading-dot").remove(),e.success||m.alert({title:e.data.errorTitle,content:e.data.errorMessage,icon:"dashicons dashicons-warning",type:"red",buttons:{ok:{text:u.i18n_ok,btnClass:"btn-confirm",keys:["enter"]}}}),m(".everest-forms-panel-content-wrap").unblock()}})}else m.alert({title:u.i18n_field_title_empty,content:u.i18n_field_title_payload,icon:"dashicons dashicons-warning",type:"red",buttons:{ok:{text:u.i18n_ok,btnClass:"btn-confirm",keys:["enter"]}}})})},getStructure:function(){var e=m(".evf-admin-field-wrapper"),n=[];return m.each(e.find(".evf-admin-row"),function(){var e=m(this),s=e.attr("data-row-id");m.each(e.find(".evf-admin-grid"),function(){var e=m(this),i=e.attr("data-grid-id"),o=0;m.each(e.find(".everest-forms-field"),function(){var e={name:"",value:""},t=m(this).attr("data-field-id");e.name="structure[row_"+s+"][grid_"+i+"]["+o+"]",o++,e.value=t,n.push(e)}),e.find(".everest-forms-field").length<1&&n.push({name:"structure[row_"+s+"][grid_"+i+"]",value:""})})}),n},getFieldArray:function(e){var t=[];return m.each(e.find(".everest-forms-field"),function(){var e=m(this).attr("data-field-id");t.push(e)}),t},checkEmptyGrid:function(e){m.each(m(".evf-admin-grid"),function(){m(this).find(".everest-forms-field, .evf-registered-item:not(.ui-draggable-dragging)").not(".ui-sortable-helper").length<1?m(this).addClass("evf-empty-grid"):m(this).removeClass("evf-empty-grid")}),h.choicesInit()},bindDefaultTabs:function(){m(document).on("click",".evf-nav-tab-wrapper a",function(e){e.preventDefault(),h.switchTab(m(this).data("panel"))})},switchTab:function(e){var t=m("#everest-forms-panel-"+e),i=m(".evf-panel-"+e+"-button");m(".evf-nav-tab-wrapper").find("a").removeClass("nav-tab-active"),i.addClass("nav-tab-active"),t.closest(".evf-tab-content").find(".everest-forms-panel").removeClass("active"),t.addClass("active"),"integrations"!==e&&"payments"!==e||(t.find(".everest-forms-panel-sidebar a").hasClass("active")||t.find(".everest-forms-panel-sidebar a").first().addClass("active"),m(".everest-forms-panel-content").find(".evf-panel-content-section").hasClass("active")||m(".everest-forms-panel-content").find(".evf-panel-content-section").first().addClass("active")),history.replaceState({},null,h.updateQueryString("tab",e)),h.switchPanel(e)},updateQueryString:function(e,t,i){i=i||window.location.href;var o,s=new RegExp("([?&])"+e+"=.*?(&|#|$)(.*)","gi");if(s.test(i))return null!=t?i.replace(s,"$1"+e+"="+t+"$2$3"):(i=(o=i.split("#"))[0].replace(s,"$1$3").replace(/(&|\?)$/,""),"undefined"!=typeof o[1]&&null!==o[1]&&(i+="#"+o[1]),i);if(null==t)return i;var n=-1!==i.indexOf("?")?"&":"?";return i=(o=i.split("#"))[0]+n+e+"="+t,"undefined"!=typeof o[1]&&null!==o[1]&&(i+="#"+o[1]),i},switchPanel:function(e){"field-options"===e&&h.switchToFieldOptionPanel()},switchToFieldOptionPanel:function(e){m(".everest-forms-field-options").find(".no-fields").hide(),m(".evf-admin-field-wrapper .everest-forms-field").removeClass("active"),m("#everest-forms-panel-fields").addClass("active"),m(".everest-forms-fields-tab").find("a").removeClass("active"),m(".everest-forms-fields-tab").find("a").last().addClass("active"),m(".everest-forms-add-fields").hide(),m(".everest-forms-field-options").show(),m(".everest-forms-field-options").find(".everest-forms-field-option").hide(),m(".evf-tab-lists").find("li a").removeClass("active"),m(".evf-tab-lists").find("li.evf-panel-field-options-button a").addClass("active"),m(document.body).trigger("evf-init-switch-field-options"),void 0!==e?(m("#everest-forms-field-option-"+e).show(),m("#everest-forms-field-"+e).addClass("active")):0<m(".evf-admin-field-wrapper .everest-forms-field").length?(m(".evf-admin-field-wrapper .everest-forms-field").eq(0).addClass("active"),m("#everest-forms-field-option-"+m(".evf-admin-field-wrapper .everest-forms-field").eq(0).attr("data-field-id")).show()):m(".everest-forms-field-options").find(".no-fields").show()},bindFields:function(){m(".evf-admin-field-wrapper").sortable({items:".evf-admin-row",axis:"y",cursor:"move",opacity:.65,scrollSensitivity:40,forcePlaceholderSize:!0,placeholder:"evf-sortable-placeholder",containment:".everest-forms-panel-content",start:function(e,t){t.item.css({"background-color":"#f7fafc",border:"1px dashed #5d96ee"})},stop:function(e,t){t.item.removeAttr("style")}}).disableSelection(),m(".evf-admin-grid").sortable({items:"> .everest-forms-field",delay:100,opacity:.65,cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,connectWith:".evf-admin-grid",containment:".everest-forms-field-wrap",out:function(e){m(".evf-admin-grid").removeClass("evf-hover"),m(e.target).removeClass("evf-item-hover"),m(e.target).closest(".evf-admin-row").removeClass("evf-hover"),h.checkEmptyGrid()},over:function(e,t){m(".evf-admin-grid").addClass("evf-hover"),m(e.target).addClass("evf-item-hover"),m(e.target).closest(".evf-admin-row").addClass("evf-hover"),h.checkEmptyGrid()},receive:function(e,t){t.sender.is("button")&&h.fieldDrop(t.helper)},stop:function(e,t){t.item.removeAttr("style"),h.checkEmptyGrid()}}).disableSelection(),m(".evf-registered-buttons button.evf-registered-item").draggable({delay:200,cancel:!1,scroll:!1,revert:"invalid",scrollSensitivity:40,forcePlaceholderSize:!0,helper:function(){return m(this).clone().insertAfter(m(this).closest(".everest-forms-tab-content").siblings(".everest-forms-fields-tab"))},opacity:.75,containment:"#everest-forms-builder",connectToSortable:".evf-admin-grid"}).disableSelection(),m(".evf-admin-row").on("mouseenter mouseleave",function(e){e.buttons<1&&("mouseenter"===e.type?m(this).addClass("evf-hover"):m(".evf-admin-row").removeClass("evf-hover"))}),m(".everest-forms-panel-content").on("scroll",function(){m(".evf-admin-grid").sortable("refreshPositions"),m(".evf-admin-field-wrapper").sortable("refreshPositions")})},fieldTabChoice:function(e){m(".everest-forms-tab-content").scrollTop(0),m(".everest-forms-fields-tab a").removeClass("active"),m(".everest-forms-field, .everest-forms-title-desc").removeClass("active"),m("#"+e).addClass("active"),"add-fields"===e?(m(".everest-forms-add-fields").show(),m(".everest-forms-field-options").hide()):("field-options"===e?(e=m(".everest-forms-field").first().data("field-id"),m(".everest-forms-field-options").show(),m(".everest-forms-field").first().addClass("active")):m("#everest-forms-field-"+e).addClass("active"),m(".everest-forms-field-option").hide(),m("#everest-forms-field-option-"+e).show(),m(".everest-forms-add-fields").hide())},bindFormPreview:function(){},bindGridSwitcher:function(){m("body").on("click",".evf-show-grid",function(e){e.stopPropagation(),h.checkEmptyGrid(),m(this).closest(".evf-toggle-row").find(".evf-toggle-row-content").stop(!0).slideToggle(200)}),m(document).click(function(){h.checkEmptyGrid(),m(".evf-show-grid").closest(".evf-toggle-row").find(".evf-toggle-row-content").stop(!0).slideUp(200)});m("body").on("click",".evf-grid-selector",function(){var e=m(this).closest(".evf-admin-row");if(!m(this).hasClass("active")){var t=parseInt(m(this).attr("data-evf-grid"),10);if(!(2<t)){var i=m('<div class="evf-admin-grid evf-grid-'+t+' ui-sortable evf-empty-grid" />'),o=m("<div/>");m.each(e.find(".evf-admin-grid"),function(){m(this).children("*").each(function(){o.append(m(this).clone())})}),e.find(".evf-admin-grid").remove(),e.find(".evf-clear ").remove(),e.append('<div class="clear evf-clear"></div>');for(var s=1;s<=t;s++)i.attr("data-grid-id",s),e.append(i.clone());e.append('<div class="clear evf-clear"></div>'),e.find(".evf-admin-grid").eq(0).append(o.html()),e.find(".evf-grid-selector").removeClass("active"),m(this).addClass("active"),h.bindFields()}}})},fieldDrop:function(a){var e=a.attr("data-field-type");a.css({left:"0",width:"100%"}).append('<i class="spinner is-active"></i>'),m.ajax({url:u.ajax_url,type:"POST",data:{action:"everest_forms_new_field_"+e,security:u.evf_field_drop_nonce,field_type:e,form_id:u.form_id},beforeSend:function(){m(document.body).trigger("init_field_options_toggle")},success:function(e){var t=e.data.preview,i=e.data.options,o=e.data.form_field_id,s=e.data.field.type,n=m(t).attr("id"),r=m(t).attr("data-field-id");m("#everest-forms-field-id").val(o),m(".everest-forms-field-options").find(".no-fields").hide(),m(".everest-forms-field-options").append(i),m(".everest-forms-field-option-row-icon_color input.colorpicker").wpColorPicker({change:function(e){var t=m(this),i=t.val(),o=t.closest(".everest-forms-field-option-row").data("field-id");m("#everest-forms-field-"+o+" .rating-icon svg").css("fill",i)}}),a.after(t),null!==m("#everest-forms-panel-field-settings-enable_survey")&&m("#everest-forms-panel-field-settings-enable_survey").prop("checked")&&m("#everest-forms-field-option-"+r+"-survey_status").prop("checked",!0),null!==m("#everest-forms-panel-field-settings-enable_quiz")&&m("#everest-forms-panel-field-settings-enable_quiz").prop("checked")&&(m("#everest-forms-field-option-"+r+"-quiz_status").prop("checked",!0),m("#everest-forms-field-option-"+r+"-quiz_status").closest(".everest-forms-field-option-row-quiz_status").siblings(".everst-forms-field-quiz-settings").removeClass("everest-forms-hidden").addClass("everest-forms-show")),a.remove(),h.checkEmptyGrid(),m(document.body).trigger("init_tooltips"),m(document.body).trigger("init_field_options_toggle"),m(document.body).trigger("evf_after_field_append",[n]),h.conditionalLogicAppendField(n),h.conditionalLogicAppendFieldIntegration(n),h.paymentFieldAppendToQuantity(n),h.paymentFieldAppendToDropdown(r,s),h.initializeRangeSliderField(r),m("#everest-forms-field-option-"+r).find(".evf-show-slider-input").attr("checked","checked"),m("#everest-forms-field-"+r).find(".evf-slider-input-wrapper").show(),h.init_datepickers()}})},conditionalLogicAppendField:function(r){var e=m("#"+r),a=e.index(),d=m(".evf-field-conditional-field-select"),l=e.attr("data-field-type"),f=e.attr("data-field-id"),c=e.find(".label-title .text ").text();m.fn.insertAt=function(e,t,i){var o=m.makeArray(this.children().clone(!0));o.splice(t,0,e),m.each(o,function(e,t){i===m(t)[0].value&&(m(t)[0].selected=!0,o[e]=t)}),this.empty().append(o)};var v=f;d.each(function(o,e){var t=m(e).val(),i=r.replace("everest-forms-field-",""),s=m(e).attr("name");if(i===s.substring(s.indexOf("[")+1,s.indexOf("]")))m(".evf-admin-row .evf-admin-grid .everest-forms-field").each(function(){var e=m(this).data("field-type"),t=m(this).data("field-id"),i=m(this).find(".label-title span").first().text();field_to_be_restricted=[],field_to_be_restricted=["html","title","address","image-upload","file-upload","date-time","hidden","scale-rating","likert"],-1===m.inArray(e,field_to_be_restricted)&&v!==t&&d.eq(o).append('<option class="evf-conditional-fields" data-field_type="'+e+'" data-field_id="'+t+'" value="'+t+'">'+i+"</option>")});else{var n='<option class="evf-conditional-fields" data-field_type="'+l+'" data-field_id="'+f+'" value="'+f+'">'+c+"</option>";"html"!==l&&"title"!==l&&"address"!==l&&"image-upload"!==l&&"file-upload"!==l&&"date-time"!==l&&"hidden"!==l&&"likert"!==l&&"scale-rating"!==l&&d.eq(o).insertAt(n,a,t)}})},paymentFieldAppendToQuantity:function(e){var t=m("#"+e),i=m(".everest-forms-field-option-row-map_field select"),o=t.attr("data-field-type"),s='<option value="'+t.attr("data-field-id")+'">'+t.find(".label-title .text ").text()+"</option>";"payment-single"!==o&&"payment-multiple"!==o&&"payment-checkbox"!==o||i.append(s)},paymentFieldAppendToDropdown:function(e,t){if("payment-quantity"===t){var i=m("#everest-forms-field-option-"+e+"-map_field");["payment-checkbox","payment-multiple","payment-single"].forEach(function(e){m(".everest-forms-field-"+e).each(function(){var e='<option value="'+m(this).attr("data-field-id")+'">'+m(this).find(".label-title .text").text()+"</option>";i.append(e)})})}},conditionalLogicAppendFieldIntegration:function(n){var r=m("#"+n),a=r.index(),d=m(".evf-provider-conditional").find(".evf-conditional-field-select"),l=r.attr("data-field-type"),f=r.attr("data-field-id"),c=r.find(".label-title .text ").text();m.fn.insertAt=function(e,t){var i=m.makeArray(this.children().clone(!0));i.splice(t,0,e),this.empty().append(i)},d.each(function(o,e){var t=n.replace("everest-forms-field-",""),i=m(e).attr("name");if(t===i.substring(i.indexOf("[")+1,i.indexOf("]")))m(".evf-admin-row .evf-admin-grid .everest-forms-field").each(function(){var e=m(this).data("field-type"),t=m(this).data("field-id"),i=m(this).find(".label-title span").first().text();field_to_be_restricted=[],field_to_be_restricted=["html","title","address","image-upload","file-upload","date-time","hidden","scale-rating","likert",r.attr("data-field-type")],-1===m.inArray(e,field_to_be_restricted)&&d.eq(o).append('<option class="evf-conditional-fields" data-field_type="'+e+'" data-field_id="'+t+'" value="'+t+'">'+i+"</option>")});else{var s='<option class="evf-conditional-fields" data-field_type="'+l+'" data-field_id="'+f+'" value="'+f+'">'+c+"</option>";"html"!==l&&"title"!==l&&"address"!==l&&"image-upload"!==l&&"file-upload"!==l&&"date-time"!==l&&"hidden"!==l&&"likert"!==l&&"scale-rating"!==l&&d.eq(o).insertAt(s,a)}})},conditionalLogicRemoveField:function(e){m(".evf-field-conditional-field-select option[value = "+e+" ]").remove()},conditionalLogicRemoveFieldIntegration:function(e){m(".evf-provider-conditional .evf-conditional-field-select option[value = "+e+" ]").remove()},paymentFieldRemoveFromQuantity:function(e){m(".everest-forms-field-option-row-map_field select option[value = "+e+" ]").remove()},bindFieldSettings:function(){m("body").on("click",".everest-forms-preview .everest-forms-field, .everest-forms-preview .everest-forms-field .everest-forms-field-setting",function(e){e.preventDefault();var t=m(this).closest(".everest-forms-field").attr("data-field-id");m(".everest-forms-tab-content").scrollTop(0),h.switchToFieldOptionPanel(t)})},toggleLabelEdit:function(e,t){m(e).toggleClass("everest-forms-hidden"),m(t).toggleClass("everest-forms-hidden"),m(t).is(":visible")&&m(t).focus()},bindToggleHandleActions:function(){m("body").on("click",".toggle-handle",function(e){var t=m(this).data("label"),i=m(this).data("input");m(i).is(":visible")||h.toggleLabelEdit(t,i)})},bindLabelEditInputActions:function(){m("body").on("focusout",".label-edit-input",function(e){var t=m(this).data("label");h.toggleLabelEdit(t,this)})},bindSyncedInputActions:function(){m("body").on("input",".sync-input",function(e){var t=m(this).val(),i=m(this).data("sync-targets");t&&i&&m(i).text(t)})}};m(function(){h.init()})}(jQuery,window.evf_data),jQuery(function(){"checked"!=jQuery("#everest-forms-panel-field-settingsemail-evf_send_confirmation_email").attr("checked")&&jQuery("#everest-forms-panel-field-settingsemail-evf_send_confirmation_email-wrap").nextAll().hide(),jQuery("#everest-forms-panel-field-settingsemail-evf_send_confirmation_email").on("change",function(){"checked"!=jQuery(this).attr("checked")?jQuery("#everest-forms-panel-field-settingsemail-evf_send_confirmation_email-wrap").nextAll().hide():jQuery("#everest-forms-panel-field-settingsemail-evf_send_confirmation_email-wrap").nextAll().show()});var e=jQuery("#everest-forms-panel-field-settings-redirect_to option:selected").val();"same"==e?(jQuery("#everest-forms-panel-field-settings-custom_page-wrap").hide(),jQuery("#everest-forms-panel-field-settings-external_url-wrap").hide()):"custom_page"==e?(jQuery("#everest-forms-panel-field-settings-custom_page-wrap").show(),jQuery("#everest-forms-panel-field-settings-external_url-wrap").hide()):"external_url"==e&&(jQuery("#everest-forms-panel-field-settings-external_url-wrap").show(),jQuery("#everest-forms-panel-field-settings-custom_page-wrap").hide()),jQuery("#everest-forms-panel-field-settings-redirect_to").on("change",function(){"same"==this.value?(jQuery("#everest-forms-panel-field-settings-custom_page-wrap").hide(),jQuery("#everest-forms-panel-field-settings-external_url-wrap").hide()):"custom_page"==this.value?(jQuery("#everest-forms-panel-field-settings-custom_page-wrap").show(),jQuery("#everest-forms-panel-field-settings-external_url-wrap").hide()):"external_url"==this.value&&(jQuery("#everest-forms-panel-field-settings-custom_page-wrap").hide(),jQuery("#everest-forms-panel-field-settings-external_url-wrap").show())}),jQuery(".evf-panel-field-options-button.evf-disabled-tab").hide()}),jQuery(function(f){f(document.body).on("init_add_fields_toogle",function(){f(".everest-forms-add-fields").on("click",".everest-forms-add-fields-group > a",function(e){e.preventDefault(),f(this).parent(".everest-forms-add-fields-group").toggleClass("closed").toggleClass("open")}),f(".everest-forms-add-fields").on("click",".everest-forms-add-fields-group a",function(){f(this).next(".evf-registered-buttons").stop().slideToggle()}),f(".everest-forms-add-fields-group.closed").each(function(){f(this).find(".evf-registered-buttons").hide()})}).trigger("init_add_fields_toogle"),f(document.body).on("click",".everest-forms-field-option .everest-forms-field-option-group > a",function(e){e.preventDefault(),f(this).parent(".everest-forms-field-option-group").toggleClass("closed").toggleClass("open")}),f(document.body).on("click",".everest-forms-field-option .everest-forms-field-option-group a",function(e){f(e.target).filter(":input, option, .sort").length||f(this).next(".everest-forms-field-option-group-inner").stop().slideToggle()}),f(document.body).on("init_field_options_toggle",function(){f(".everest-forms-field-option-group.closed").each(function(){f(this).find(".everest-forms-field-option-group-inner").hide()})}).trigger("init_field_options_toggle"),f(document).click(function(){f(".evf-smart-tag-lists").hide()}),f(document.body).on("click",".evf-toggle-smart-tag-display",function(e){e.stopPropagation(),f(".evf-smart-tag-lists").hide(),f(".evf-smart-tag-lists ul").empty(),f(this).parent().find(".evf-smart-tag-lists").toggle("show");var t=f(this).data("type");!function l(s,e,t){var n=[],r=[],a=[];if(f(".evf-admin-row .evf-admin-grid .everest-forms-field").each(function(){var e=f(this).data("field-type"),t=f(this).data("field-id");if(s===e){var i=f(this).find(".label-title span").first().text();a[t]=i}else{var o=f(this).find(".label-title span").first().text();n[t]=o}r[t]=f(this).find(".label-title span").first().text()}),"other"===e||"all"===e){var i=evf_data.smart_tags_other;for(var o in i)f(t).parent().find(".evf-smart-tag-lists .evf-others").append('<li class = "smart-tag-field" data-type="other" data-field_id="'+o+'">'+i[o]+"</li>")}if("fields"===e||"all"===e)if("email"===s)for(var o in Object.keys(a).length<1?f(t).parent().find('.evf-smart-tag-lists .smart-tag-title:not(".other-tag-title")').addClass("everest-forms-hidden"):f(t).parent().find('.evf-smart-tag-lists .smart-tag-title:not(".other-tag-title")').removeClass("everest-forms-hidden"),f(t).parent().find(".evf-smart-tag-lists .other-tag-title").remove(),f(t).parent().find(".evf-smart-tag-lists .evf-others").remove(),f(t).parent().find(".evf-smart-tag-lists").append('<div class="smart-tag-title other-tag-title">Others</div><ul class="evf-others"></ul>'),f(t).parent().find(".evf-smart-tag-lists .evf-others").append('<li class="smart-tag-field" data-type="other" data-field_id="admin_email">Site Admin Email</li><li class="smart-tag-field" data-type="other" data-field_id="user_email">User Email</li>'),a)f(t).parent().find(".evf-smart-tag-lists .evf-fields").append('<li class = "smart-tag-field" data-type="field" data-field_id="'+o+'">'+a[o]+"</li>");else for(var d in Object.keys(r).length<1?f(t).parent().find('.evf-smart-tag-lists .smart-tag-title:not(".other-tag-title")').addClass("everest-forms-hidden"):f(t).parent().find('.evf-smart-tag-lists .smart-tag-title:not(".other-tag-title")').removeClass("everest-forms-hidden"),r)f(t).parent().find(".evf-smart-tag-lists .evf-fields").append('<li class = "smart-tag-field" data-type="field" data-field_id="'+d+'">'+r[d]+"</li>")}(f(this).data("fields"),t,f(this))}),f(document.body).on("change",".everest-forms-toggle-form input",function(e){e.stopPropagation(),f.post(evf_data.ajax_url,{action:"everest_forms_enabled_form",security:evf_data.evf_enabled_form,form_id:f(this).data("form_id"),enabled:f(this).attr("checked")?1:0})}),f(document.body).on("click",".smart-tag-field",function(e){var t=f(this).data("field_id"),i=f(this).text(),o=f(this).data("type"),s=f(this).parent().parent().parent(),n=s.find("input[type=text]"),r=s.find("textarea");if("fullname"!==t&&"email"!==t&&"subject"!==t&&"message"!==t&&"other"!==o){i=i.split(/[\s-_]/);for(var a=0;a<i.length;a++)i[a]=0===a?i[a].charAt(0).toLowerCase()+i[a].substr(1):i[a].charAt(0).toUpperCase()+i[a].substr(1);t=(i=i.join(""))+"_"+t}else t=t;"field"===o?(n.val(n.val()+'{field_id="'+t+'"}'),r.val(r.val()+'{field_id="'+t+'"}')):"other"===o&&(n.val(n.val()+"{"+t+"}"),r.val(r.val()+"{"+t+"}"))}),f(document).on("change",".evf-content-email-settings .evf-toggle-switch input",function(e){var t=f(this),i=t.prop("checked");!1===i?(f(this).closest("#everest-forms-panel-settings").find(".everest-forms-active-email").addClass("everest-forms-hidden"),t.closest(".evf-content-email-settings").find(".email-disable-message").remove(),t.closest(".evf-content-section-title").siblings(".evf-content-email-settings-inner").addClass("everest-forms-hidden"),f('<p class="email-disable-message everest-forms-notice everest-forms-notice-info">'+evf_data.i18n_email_disable_message+"</p>").insertAfter(t.closest(".evf-content-section-title"))):!0===i&&(f(this).closest("#everest-forms-panel-settings").find(".everest-forms-active-email").removeClass("everest-forms-hidden"),t.closest(".evf-content-section-title").siblings(".evf-content-email-settings-inner").removeClass("everest-forms-hidden"),t.closest(".evf-content-email-settings").find(".email-disable-message").remove())}),f(document).on("click",".everest-forms-min-max-date-format input",function(){f(this).is(":checked")?f(".everest-forms-min-max-date-option").removeClass("everest-forms-hidden"):f(".everest-forms-min-max-date-option").addClass("everest-forms-hidden")})});