jQuery(function(d){"use strict";d('form[data-ajax_submission="1"]').each(function(e,s){d(document).ready(function(){var n=d(s),f=n.find(".evf-submit");0<n.find("[data-gateway*='stripe']:visible").length||f.on("click",function(e){var s=n.serializeArray();e.preventDefault(),n.trigger("focusout").trigger("change").trigger("submit");var r=n.find(".evf-error:visible");0<r.length?d([document.documentElement,document.body]).animate({scrollTop:r.last().offset().top},800):(d(this).html(n.data("process-text")),s.push({name:"action",value:"everest_forms_ajax_form_submission"}),s.push({name:"security",value:everest_forms_ajax_submission_params.evf_ajax_submission}),d.ajax({url:everest_forms_ajax_submission_params.ajax_url,type:"POST",data:s}).done(function(e,s,r){if("undefined"!=typeof e.data.redirect_url)return n.trigger("reset"),void(window.location=e.data.redirect_url);if("success"===e.data.response||!0===e.success)n.trigger("reset"),n.closest(".everest-forms").html('<div class="everest-forms-notice everest-forms-notice--success" role="alert">'+e.data.message+"</div>").focus();else{var i=n.data("formid"),t=everest_forms_ajax_submission_params.error,a=JSON.parse(r.responseText),o=a.data.error;"string"==typeof a.data.message&&(t=a.data.message),n.closest(".everest-forms").find(".everest-forms-notice").remove(),n.closest(".everest-forms").prepend('<div class="everest-forms-notice everest-forms-notice--error" role="alert">'+t+"</div>").focus(),d(o).each(function(e,s){var t,a=Object.values(s)[0],r=!0;switch(Object.keys(s)[0]){case"signature":t=d("#"+("evf-signature-img-input-"+a));break;case"likert":r=!1,(t=d('[id^="'+("everest_forms-"+i+"-field_"+a+"_")+'"]')).each(function(e,s){var r=d(s).closest("tr.evf-"+i+"-field_"+a).find("th"),t="everest_forms[form_fields]["+a+"]["+(parseInt(r.closest("tr").index())+1)+"]";r.children().is("label")?r.children().find("#"+t).show():r.append('<label id="'+t+'" for="'+t+'" class="evf-error">'+everest_forms_ajax_submission_params.required+"</label>")});break;case"address":(t=d('[id^="'+("evf-"+i+"-field_"+a)+'"]')).each(function(e,s){var r=String(d(s).attr("id"));(r.includes("-container")||r.includes("-address2")||void 0!==d(s).val())&&t.splice(e,1)});break;default:t=d("#"+("evf-"+i+"-field_"+a))}t.addClass("evf-error"),t.attr("required",!0),t.attr("aria-invalid",!0),t.first().closest(".evf-field").addClass("everest-forms-invalid evf-has-error"),!0!==r||t.is("label")||t.after('<label id="'+t.attr("id")+'-error" class="evf-error" for="'+t.attr("id")+'">'+everest_forms_ajax_submission_params.required+"</label>").show()}),f.attr("disabled",!1).html(everest_forms_ajax_submission_params.submit)}}).fail(function(){f.attr("disabled",!1).html(everest_forms_ajax_submission_params.submit),n.trigger("focusout").trigger("change"),n.closest(".everest-forms").find(".everest-forms-notice").remove(),n.closest(".everest-forms").prepend('<div class="everest-forms-notice everest-forms-notice--error" role="alert">'+everest_forms_ajax_submission_params.error+"</div>").focus()}).always(function(e){"undefined"==typeof e.data.redirect_url&&d([document.documentElement,document.body]).animate({scrollTop:d(".everest-forms-notice").offset().top},800)}))})})})});