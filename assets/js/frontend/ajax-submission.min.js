jQuery(function(d){"use strict";d('form[data-ajax_submission="1"]').each(function(e,r){d(document).ready(function(){var t=d(r),i=t.find(".evf-submit"),e=t.find("[data-gateway*='stripe']");0<e.length&&0===e.children.length||i.on("click",function(e){"undefined"!=typeof tinyMCE&&tinyMCE.triggerSave();var r=i.get(0).recaptchaID;if(0===r)return grecaptcha.execute(r),!1;r=t.serializeArray();e.preventDefault(),t.trigger("focusout").trigger("change").trigger("submit");e=t.find(".evf-error:visible");0<e.length?d([document.documentElement,document.body]).animate({scrollTop:e.last().offset().top},800):(d(this).html(t.data("process-text")),r.push({name:"action",value:"everest_forms_ajax_form_submission"}),r.push({name:"security",value:everest_forms_ajax_submission_params.evf_ajax_submission}),d.ajax({url:everest_forms_ajax_submission_params.ajax_url,type:"POST",data:r}).done(function(s,e,r){var a=s.data&&s.data.redirect_url?s.data.redirect_url:"";if(a)return t.trigger("reset"),void(window.location=a);if("success"===s.data.response||!0===s.success){let e="",r="";s.data.form_id!==undefined&&s.data.entry_id!==undefined&&1==s.data.pdf_download&&(e='<br><small><a href="/?page=evf-entries-pdf&form_id='+s.data.form_id+"&entry_id="+s.data.entry_id+'">'+s.data.pdf_download_message+"</a></small>"),1==s.data.quiz_result_shown&&(r=s.data.quiz_reporting),t.trigger("reset"),t.closest(".everest-forms").html('<div class="everest-forms-notice everest-forms-notice--success" role="alert">'+s.data.message+e+"</div>"+r).focus(),localStorage.removeItem(t.attr("id"))}else{var o=t.data("formid"),a=JSON.parse(r.responseText);s="undefined"!=typeof a.data[o]?a.data[o].header:everest_forms_ajax_submission_params.error;r=a.data.error;"string"==typeof a.data.message&&(s=a.data.message),t.closest(".everest-forms").find(".everest-forms-notice").remove(),t.closest(".everest-forms").prepend('<div class="everest-forms-notice everest-forms-notice--error" role="alert">'+s+"</div>").focus(),d(r).each(function(e,r){var a,s=Object.values(r)[0],t=Object.keys(r)[0],i=!0,r="evf"-+o+"-field_"+t+"-container";d("#"+r).hasClass("evf-field-signature")?a=d("#"+("evf-signature-img-input-"+t)):d("#"+r).hasClass("evf-field-likert")?(i=!1,(a=d('[id^="'+("everest_forms-"+o+"-field_"+t+"_")+'"]')).each(function(e,r){var s=d(r).closest("tr.evf-"+o+"-field_"+t).find("th"),r="everest_forms[form_fields]["+t+"]["+(parseInt(s.closest("tr").index())+1)+"]";s.children().is("label")?s.children().find("#"+r).show():s.append('<label id="'+r+'" for="'+r+'" class="evf-error">'+everest_forms_ajax_submission_params.required+"</label>")})):d("#"+r).hasClass("evf-field-address")?(a=d('[id^="'+("evf-"+o+"-field_"+t)+'"]')).each(function(e,r){var s=String(d(r).attr("id"));(s.includes("-container")||s.includes("-address2")||void 0!==d(r).val())&&a.splice(e,1)}):a=d("#"+("evf-"+o+"-field_"+t)),a.addClass("evf-error"),a.attr("aria-invalid",!0),a.first().closest(".evf-field").addClass("everest-forms-invalid evf-has-error"),!0!==i||a.is("label")||a.after('<label id="'+a.attr("id")+'-error" class="evf-error" for="'+a.attr("id")+'">'+s+"</label>").show()}),i.attr("disabled",!1).html(everest_forms_ajax_submission_params.submit)}}).fail(function(){i.attr("disabled",!1).html(everest_forms_ajax_submission_params.submit),t.trigger("focusout").trigger("change"),t.closest(".everest-forms").find(".everest-forms-notice").remove(),t.closest(".everest-forms").prepend('<div class="everest-forms-notice everest-forms-notice--error" role="alert">'+everest_forms_ajax_submission_params.error+"</div>").focus()}).always(function(e){!(e.data&&e.data.redirect_url?e.data.redirect_url:"")&&d(".everest-forms-notice").length&&d([document.documentElement,document.body]).animate({scrollTop:d(".everest-forms-notice").offset().top},800)}))})})})});