jQuery(function(u){"use strict";if("undefined"==typeof everest_forms_params)return!1;var t={$everest_form:u("form.everest-form"),init:function(){this.init_range_sliders(),this.init_inputMask(),this.init_mailcheck(),this.init_datepicker(),this.load_validation(),this.submission_scroll(),this.randomize_elements(),this.init_enhanced_select(),this.$everest_form.on("input validate change",".input-text, select, input:checkbox, input:radio",this.validate_field)},init_range_sliders:function(){u(".evf-field.evf-field-range-slider").show(),u(".evf-field-range-slider .evf-field-primary-input").ionRangeSlider({onFinish:function(e){var i=e.input.closest(".evf-field");t.setPrefixPostfixTexts(null,null,i)}}).on("change",function(){var e=u(this).val();u(this).closest(".evf-field-range-slider").find(".evf-slider-input").val(e),t.setSliderColors(u(this).closest(".evf-field"))}),u(".evf-field-range-slider .evf-slider-input").on("input",function(){var e=u(this).val(),i=u(this).closest(".evf-field");u(this).closest(".evf-field-range-slider").find(".evf-field-primary-input").data("ionRangeSlider").update({from:e}),t.setPrefixPostfixTexts(null,null,i)}),u(".evf-field-range-slider .evf-range-slider-reset-icon").on("click",function(e){var i=u(this).closest(".evf-field"),s=i.find(".evf-field-primary-input").data("default");i.find(".evf-field-primary-input").data("ionRangeSlider").update({from:s}),t.setSliderColors(u(this).closest(".evf-field")),t.setPrefixPostfixTexts(null,null,i)}),u(".evf-field.evf-field-range-slider").each(function(){var e=u(this).closest(".evf-field");t.setSliderColors(this),t.setPrefixPostfixTexts(null,null,e)})},setPrefixPostfixTexts:function(e,i,s){var a=null!==s&&undefined!==s;if(e&&""!==e&&i&&""!==i||a){var t=(s=a?s:u("#evf-"+i+"-field_"+e+"-container")).find(".evf-field-primary-input"),r=t.data("use-text-prefix-postfix"),l=t.data("prefix-text"),n=t.data("postfix-text");!0===r&&(s.find("span.irs-min").html(l),s.find("span.irs-max").html(n))}},setSliderColors:function(e){var i=u(e).find(".evf-field-primary-input"),s=i.data("highlight_color"),a=i.data("track_color");t.setSliderHandleColor(e),u(e).find(".irs-bar").css("background",s),u(e).find(".irs-line").css("background",a)},setSliderHandleColor:function(e){if(e){var i=u(e),s=i.attr("id"),a=i.find(".evf-field-primary-input").data("skin"),t=i.find(".evf-field-primary-input").data("handle_color"),r="";switch(a){case"flat":i.find(".irs-handle i").first().css("background-color",t),i.find(".irs-single").css("background-color",t),r="#"+s+" .irs-single:before { border-top-color: "+t+"!important; }";break;case"big":i.find(".irs-single").css("background-color",t),i.find(".irs-single").css("background",t),i.find(".irs-handle").css("background-color",t),i.find(".irs-handle").css("background",t);break;case"modern":i.find(".irs-handle i").css("background",t),i.find(".irs-single").css("background-color",t),r="#"+s+" .irs-single:before { border-top-color: "+t+"!important; }";break;case"sharp":i.find(".irs-handle").css("background-color",t),i.find(".irs-handle i").first().css("border-top-color",t),i.find(".irs-single").css("background-color",t),r="#"+s+" .irs-single:before { border-top-color: "+t+"!important; }";break;case"round":case"square":i.find(".irs-handle").css("border-color",t),i.find(".irs-single").css("background-color",t),r="#"+s+" .irs-single:before { border-top-color: "+t+"!important; }"}u("body").find(".evf-range-slider-handle-style-tag-"+s).remove(),u("body").append('<style class="evf-range-slider-handle-style-tag-'+s+'" >'+r+"</style>")}},init_inputMask:function(){"undefined"!=typeof u.fn.inputmask&&u(".evf-masked-input").inputmask()},init_mailcheck:function(){"undefined"!=typeof u.fn.mailcheck&&everest_forms_params.mailcheck_enabled&&(0<everest_forms_params.mailcheck_domains.length&&(Mailcheck.defaultDomains=Mailcheck.defaultDomains.concat(everest_forms_params.mailcheck_domains)),0<everest_forms_params.mailcheck_toplevel_domains.length&&(Mailcheck.defaultTopLevelDomains=Mailcheck.defaultTopLevelDomains.concat(everest_forms_params.mailcheck_toplevel_domains)),u(document).on("blur",".evf-field-email input",function(){var e=u(this),a=e.attr("id");e.mailcheck({suggested:function(e,i){u("#"+a+"_suggestion").remove();var s=everest_forms_params.i18n_messages_email_suggestion.replace("{suggestion}",'<a href="#" class="mailcheck-suggestion" data-id="'+a+'" title="'+everest_forms_params.i18n_messages_email_suggestion_title+'">'+i.full+"</a>");u(e).after('<label class="evf-error mailcheck-error" id="'+a+'_suggestion">'+s+"</label>")},empty:function(){u("#"+a+"_suggestion").remove()}})}),u(document).on("click",".evf-field-email .mailcheck-suggestion",function(e){var i=u(this),s=i.attr("data-id");e.preventDefault(),u("#"+s).val(i.text()),i.parent().remove()}))},init_datepicker:function(){0<u(".evf-field-date-time").length&&u(".flatpickr-field").each(function(){var e=5,i=u(this).data(),s=[];switch(i.disableDates&&(s=i.disableDates.split(",")),i.dateTime){case"date":u(this).flatpickr({disableMobile:!0,mode:i.mode,minDate:i.minDate,maxDate:i.maxDate,dateFormat:i.dateFormat,disable:s});break;case"time":undefined!==i.timeInterval&&(e=parseInt(i.timeInterval,10)),u(this).flatpickr({enableTime:!0,noCalendar:!0,minuteIncrement:e,dateFormat:i.dateFormat,disableMobile:!0,time_24hr:i.dateFormat.includes("H:i")});break;case"date-time":undefined!==i.timeInterval&&(e=parseInt(i.timeInterval,10)),u(this).flatpickr({enableTime:!0,noCalendar:!1,disableMobile:!0,mode:i.mode,minDate:i.minDate,maxDate:i.maxDate,minuteIncrement:e,dateFormat:i.dateFormat,time_24hr:i.dateFormat.includes("H:i"),disable:s})}})},load_validation:function(){if("undefined"==typeof u.fn.validate)return!1;u(".evf-field-url input[type=url]").change(function(){var e=u(this).val();if(!e)return!1;"http://"!==e.substr(0,7)&&"https://"!==e.substr(0,8)&&u(this).val("http://"+e)}),u.extend(u.validator.messages,{required:everest_forms_params.i18n_messages_required,url:everest_forms_params.i18n_messages_url,email:everest_forms_params.i18n_messages_email,number:everest_forms_params.i18n_messages_number}),u.validator.methods.email=function(e,i){var s=new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i);return this.optional(i)||s.test(e)},u.validator.addMethod("confirm",function(e,i,s){return u.validator.methods.equalTo.call(this,e,i,s)},everest_forms_params.i18n_messages_confirm),u.validator.addMethod("check-limit",function(e,i){var s=u(i).closest("ul"),a=s.find('input[type="checkbox"]:checked'),t=parseInt(s.attr("data-choice-limit")||0,10);return 0===t||a.length<=t},function(e,i){var s=parseInt(u(i).closest("ul").attr("data-choice-limit")||0,10);return everest_forms_params.i18n_messages_check_limit.replace("{#}",s)}),this.$everest_form.each(function(){var e=u(this),f={};u(".evf-field").each(function(){var e=u(this).closest("form").data("formid"),i=u(this).data("field-id"),s=u(this).data("required-field-message"),a="everest_forms[form_fields]["+i+"]";if(u(this).is(".evf-field-payment-single"))u(this).find(".evf-payment-price").is(".evf-payment-user-input")||(u(this).find(".evf-payment-price").attr("required",!1),s=null);else if(u(this).is(".evf-field-checkbox, .evf-field-payment-checkbox"))a+="[]";else if(u(this).is(".evf-field-file-upload, .evf-field-image-upload"))a="evf_"+e+"_"+i;else if(u(this).is(".evf-field-signature"))a="everest_forms[form_fields]["+i+"][signature_image]";else if(u(this).is(".evf-field-phone"))a+="[phone_field]";else if(u(this).is(".evf-field-email")||u(this).is(".evf-field-password"))f[a="everest_forms[form_fields]["+i+"]"]={required:s},f[a="everest_forms[form_fields]["+i+"][primary]"]={required:s},f[a="everest_forms[form_fields]["+i+"][secondary]"]={required:s},s=null;else if(u(this).is(".evf-field-address")){for(var t={address1:u(this).data("required-field-message-address1"),city:u(this).data("required-field-message-city"),state:u(this).data("required-field-message-state"),postal:u(this).data("required-field-message-postal"),country:u(this).data("required-field-message-country")},r=Object.keys(t),l=0;l<r.length;l++){var n=r[l];s=t[r[l]];f[a="everest_forms[form_fields]["+i+"]["+n+"]"]={required:s}}s=null}else if(u(this).is(".evf-field-likert")){var d=u(this).data("row-keys");t={};if(d&&Array.isArray(d)){for(l=0;l<d.length;l++){var o=d[l];t[o]=u(this).data("required-field-message-"+o)}for(l=0;l<d.length;l++)s=t[d[l]],a="everest_forms[form_fields]["+i+"]["+d[l]+"]",f[a]={required:s}}s=null}s&&(f[a]={required:s})}),e.validate({messages:f,ignore:"",errorClass:"evf-error",validClass:"evf-valid",errorPlacement:function(e,i){i.closest(".evf-field").is(".evf-field-range-slider")?i.closest(".evf-field").find(".evf-field-description").length?i.closest(".evf-field").find(".evf-field-description").before(e):i.closest(".evf-field").append(e):i.closest(".evf-field").is(".evf-field-scale-rating")?i.closest(".evf-field").find(".everest-forms-field-scale-rating").after(e):"radio"===i.attr("type")||"checkbox"===i.attr("type")?i.hasClass("everest-forms-likert-field-option")?i.closest("tr").children("th").append(e):(i.closest(".evf-field-checkbox").find("label.evf-error").remove(),i.parent().parent().parent().append(e)):i.is("select")&&i.attr("class").match(/date-month|date-day|date-year/)?0===i.parent().find("label.evf-error:visible").length&&i.parent().find("select:last").after(e):i.hasClass("evf-smart-phone-field")||i.hasClass("everest-forms-field-password-primary")||i.hasClass("everest-forms-field-password-secondary")?i.parent().after(e):e.insertAfter(i)},highlight:function(e,i,s){var a=u(e),t=a.closest(".form-row"),r=a.attr("name");"radio"===a.attr("type")||"checkbox"===a.attr("type")?t.find("input[name='"+r+"']").addClass(i).removeClass(s):a.addClass(i).removeClass(s),t.removeClass("everest-forms-validated").addClass("everest-forms-invalid evf-has-error")},unhighlight:function(e,i,s){var a=u(e),t=a.closest(".form-row"),r=a.attr("name");"radio"===a.attr("type")||"checkbox"===a.attr("type")?t.find("input[name='"+r+"']").addClass(s).removeClass(i):a.addClass(s).removeClass(i),t.removeClass("evf-has-error")},submitHandler:function(e){var i=u(e),s=i.find(".evf-submit"),a=s.data("process-text");a&&s.text(a).prop("disabled",!0),1!==i.data("ajax_submission")&&e.submit()},onkeyup:function(e,i){u(e).hasClass("everest-forms-novalidate-onkeyup")||9===i.which&&""===this.elementValue(e)||-1!==u.inArray(i.keyCode,[16,17,18,20,35,36,37,38,39,40,45,144,225])||(e.name in this.submitted||e.name in this.invalid)&&this.element(e)},onfocusout:function(e){var i=!1;u(e).hasClass("everest-forms-novalidate-onkeyup")&&!e.value&&(i=!0),this.checkable(e)||!(e.name in this.submitted)&&this.optional(e)||(i=!0),i&&this.element(e)},onclick:function(e){var i=!1;"checkbox"===(e||{}).type?(u(e).closest(".evf-field-checkbox").find("label.evf-error").remove(),i=!0):u(e).valid(),i&&this.element(e)}})})},validate_field:function(e){var i=u(this),s=i.closest(".form-row"),a=!0,t=s.is(".validate-required"),r=s.is(".validate-email"),l=e.type;if(s.hasClass("evf-field-address")||s.hasClass("evf-field-payment-single"))0===s.find("input.evf-error").length&&s.removeClass("everest-forms-invalid everest-forms-invalid-required-field everest-forms-invalid-email").addClass("everest-forms-validated");else if("input"===l&&s.removeClass("everest-forms-invalid everest-forms-invalid-required-field everest-forms-invalid-email everest-forms-validated"),"validate"===l||"change"===l){if(t&&(i.hasClass("everest-forms-likert-field-option")?0<s.find("input.evf-error").length&&(s.removeClass("everest-forms-validated").addClass("everest-forms-invalid everest-forms-invalid-required-field"),a=!1):("checkbox"===i.attr("type")&&0===s.find("input:checked").length||""===i.val())&&(s.removeClass("everest-forms-validated").addClass("everest-forms-invalid everest-forms-invalid-required-field"),a=!1)),r)if(i.val())new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i).test(i.val())||(s.removeClass("everest-forms-validated").addClass("everest-forms-invalid everest-forms-invalid-email"),a=!1);a&&s.removeClass("everest-forms-invalid everest-forms-invalid-required-field everest-forms-invalid-email").addClass("everest-forms-validated")}},submission_scroll:function(){u("div.everest-forms-submission-scroll").length&&u("html,body").animate({scrollTop:u("div.everest-forms-submission-scroll").offset().top-100},1e3)},randomize_elements:function(){u(".everest-forms-randomize").each(function(){for(var e=u(this),i=e.children();i.length;)e.append(i.splice(Math.floor(Math.random()*i.length),1)[0])})},init_enhanced_select:function(){"undefined"!=typeof u.fn.selectWoo&&u("select.evf-enhanced-select:visible").each(function(){var e=u.extend({placeholder:u(this).attr("placeholder")||""},{language:{noResults:function(){return everest_forms_params.i18n_no_matches}}});u(this).selectWoo(e)})}};t.init()});